<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE CPP #-}</span><span>
</span><a name="line-2"></a><span class="hs-cpp">#if __GLASGOW_HASKELL__ &lt; 710</span><span>
</span><a name="line-3"></a><span class="hs-pragma">{-# OPTIONS_GHC -fno-warn-amp #-}</span><span>
</span><a name="line-4"></a><span class="hs-cpp">#endif</span><span>
</span><a name="line-5"></a><span class="hs-cpp">#if __GLASGOW_HASKELL__</span><span>
</span><a name="line-6"></a><span class="hs-pragma">{-# LANGUAGE DeriveDataTypeable, StandaloneDeriving #-}</span><span>
</span><a name="line-7"></a><span class="hs-cpp">#endif</span><span>
</span><a name="line-8"></a><span class="hs-comment">-----------------------------------------------------------------------------</span><span>
</span><a name="line-9"></a><span class="hs-comment">-- |</span><span>
</span><a name="line-10"></a><span class="hs-comment">-- Module      :  Data.MultiSet</span><span>
</span><a name="line-11"></a><span class="hs-comment">-- Copyright   :  (c) Twan van Laarhoven 2008</span><span>
</span><a name="line-12"></a><span class="hs-comment">-- License     :  BSD-style</span><span>
</span><a name="line-13"></a><span class="hs-comment">-- Maintainer  :  libraries@haskell.org</span><span>
</span><a name="line-14"></a><span class="hs-comment">-- Stability   :  provisional</span><span>
</span><a name="line-15"></a><span class="hs-comment">-- Portability :  portable</span><span>
</span><a name="line-16"></a><span class="hs-comment">--</span><span>
</span><a name="line-17"></a><span class="hs-comment">-- An efficient implementation of multisets, also sometimes called bags.</span><span>
</span><a name="line-18"></a><span class="hs-comment">--</span><span>
</span><a name="line-19"></a><span class="hs-comment">-- A multiset is like a set, but it can contain multiple copies of the same element.</span><span>
</span><a name="line-20"></a><span class="hs-comment">-- Unless otherwise specified all insert and remove opertions affect only a single copy of an element.</span><span>
</span><a name="line-21"></a><span class="hs-comment">-- For example the minimal element before and after @deleteMin@ could be the same, only with one less occurrence.</span><span>
</span><a name="line-22"></a><span class="hs-comment">--</span><span>
</span><a name="line-23"></a><span class="hs-comment">-- Since many function names (but not the type name) clash with</span><span>
</span><a name="line-24"></a><span class="hs-comment">-- &quot;Prelude&quot; names, this module is usually imported @qualified@, e.g.</span><span>
</span><a name="line-25"></a><span class="hs-comment">--</span><span>
</span><a name="line-26"></a><span class="hs-comment">-- &gt;  import Data.MultiSet (MultiSet)</span><span>
</span><a name="line-27"></a><span class="hs-comment">-- &gt;  import qualified Data.MultiSet as MultiSet</span><span>
</span><a name="line-28"></a><span class="hs-comment">--</span><span>
</span><a name="line-29"></a><span class="hs-comment">-- The implementation of 'MultiSet' is based on the &quot;Data.Map&quot; module.</span><span>
</span><a name="line-30"></a><span class="hs-comment">--</span><span>
</span><a name="line-31"></a><span class="hs-comment">-- Note that the implementation is /left-biased/ -- the elements of a</span><span>
</span><a name="line-32"></a><span class="hs-comment">-- first argument are always preferred to the second, for example in</span><span>
</span><a name="line-33"></a><span class="hs-comment">-- 'union' or 'insert'.  Of course, left-biasing can only be observed</span><span>
</span><a name="line-34"></a><span class="hs-comment">-- when equality is an equivalence relation instead of structural</span><span>
</span><a name="line-35"></a><span class="hs-comment">-- equality.</span><span>
</span><a name="line-36"></a><span class="hs-comment">--</span><span>
</span><a name="line-37"></a><span class="hs-comment">-- In the complexity of functions /n/ refers to the number of distinct elements,</span><span>
</span><a name="line-38"></a><span class="hs-comment">-- /t/ is the total number of elements.</span><span>
</span><a name="line-39"></a><span class="hs-comment">-----------------------------------------------------------------------------</span><span>
</span><a name="line-40"></a><span>
</span><a name="line-41"></a><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">MultiSet</span><span>  </span><span class="hs-special">(</span><span> </span><span>
</span><a name="line-42"></a><span>            </span><span class="hs-comment">-- * MultiSet type</span><span>
</span><a name="line-43"></a><span>              </span><a href="Data.MultiSet.html#MultiSet"><span class="hs-identifier hs-type">MultiSet</span></a><span class="hs-special">,</span><span> </span><a href="Data.MultiSet.html#Occur"><span class="hs-identifier hs-type">Occur</span></a><span>
</span><a name="line-44"></a><span>
</span><a name="line-45"></a><span>            </span><span class="hs-comment">-- * Operators</span><span>
</span><a name="line-46"></a><span>            </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><a href="Data.MultiSet.html#%5C%5C"><span class="hs-operator hs-var">\\</span></a><span class="hs-special">)</span><span>
</span><a name="line-47"></a><span>
</span><a name="line-48"></a><span>            </span><span class="hs-comment">-- * Query</span><span>
</span><a name="line-49"></a><span>            </span><span class="hs-special">,</span><span> </span><a href="Data.MultiSet.html#null"><span class="hs-identifier hs-var">null</span></a><span>
</span><a name="line-50"></a><span>            </span><span class="hs-special">,</span><span> </span><a href="Data.MultiSet.html#size"><span class="hs-identifier hs-var">size</span></a><span>
</span><a name="line-51"></a><span>            </span><span class="hs-special">,</span><span> </span><a href="Data.MultiSet.html#distinctSize"><span class="hs-identifier hs-var">distinctSize</span></a><span>
</span><a name="line-52"></a><span>            </span><span class="hs-special">,</span><span> </span><a href="Data.MultiSet.html#member"><span class="hs-identifier hs-var">member</span></a><span>
</span><a name="line-53"></a><span>            </span><span class="hs-special">,</span><span> </span><a href="Data.MultiSet.html#notMember"><span class="hs-identifier hs-var">notMember</span></a><span>
</span><a name="line-54"></a><span>            </span><span class="hs-special">,</span><span> </span><a href="Data.MultiSet.html#occur"><span class="hs-identifier hs-var">occur</span></a><span>
</span><a name="line-55"></a><span>            </span><span class="hs-special">,</span><span> </span><a href="Data.MultiSet.html#isSubsetOf"><span class="hs-identifier hs-var">isSubsetOf</span></a><span>
</span><a name="line-56"></a><span>            </span><span class="hs-special">,</span><span> </span><a href="Data.MultiSet.html#isProperSubsetOf"><span class="hs-identifier hs-var">isProperSubsetOf</span></a><span>
</span><a name="line-57"></a><span>
</span><a name="line-58"></a><span>            </span><span class="hs-comment">-- * Construction</span><span>
</span><a name="line-59"></a><span>            </span><span class="hs-special">,</span><span> </span><a href="Data.MultiSet.html#empty"><span class="hs-identifier hs-var">empty</span></a><span>
</span><a name="line-60"></a><span>            </span><span class="hs-special">,</span><span> </span><a href="Data.MultiSet.html#singleton"><span class="hs-identifier hs-var">singleton</span></a><span>
</span><a name="line-61"></a><span>            </span><span class="hs-special">,</span><span> </span><a href="Data.MultiSet.html#insert"><span class="hs-identifier hs-var">insert</span></a><span>
</span><a name="line-62"></a><span>            </span><span class="hs-special">,</span><span> </span><a href="Data.MultiSet.html#insertMany"><span class="hs-identifier hs-var">insertMany</span></a><span>
</span><a name="line-63"></a><span>            </span><span class="hs-special">,</span><span> </span><a href="Data.MultiSet.html#delete"><span class="hs-identifier hs-var">delete</span></a><span>
</span><a name="line-64"></a><span>            </span><span class="hs-special">,</span><span> </span><a href="Data.MultiSet.html#deleteMany"><span class="hs-identifier hs-var">deleteMany</span></a><span>
</span><a name="line-65"></a><span>            </span><span class="hs-special">,</span><span> </span><a href="Data.MultiSet.html#deleteAll"><span class="hs-identifier hs-var">deleteAll</span></a><span>
</span><a name="line-66"></a><span>
</span><a name="line-67"></a><span>            </span><span class="hs-comment">-- * Combine</span><span>
</span><a name="line-68"></a><span>            </span><span class="hs-special">,</span><span> </span><a href="Data.MultiSet.html#union"><span class="hs-identifier hs-var">union</span></a><span class="hs-special">,</span><span> </span><a href="Data.MultiSet.html#unions"><span class="hs-identifier hs-var">unions</span></a><span>
</span><a name="line-69"></a><span>            </span><span class="hs-special">,</span><span> </span><a href="Data.MultiSet.html#maxUnion"><span class="hs-identifier hs-var">maxUnion</span></a><span>
</span><a name="line-70"></a><span>            </span><span class="hs-special">,</span><span> </span><a href="Data.MultiSet.html#difference"><span class="hs-identifier hs-var">difference</span></a><span>
</span><a name="line-71"></a><span>            </span><span class="hs-special">,</span><span> </span><a href="Data.MultiSet.html#intersection"><span class="hs-identifier hs-var">intersection</span></a><span>
</span><a name="line-72"></a><span>
</span><a name="line-73"></a><span>            </span><span class="hs-comment">-- * Filter</span><span>
</span><a name="line-74"></a><span>            </span><span class="hs-special">,</span><span> </span><a href="Data.MultiSet.html#filter"><span class="hs-identifier hs-var">filter</span></a><span>
</span><a name="line-75"></a><span>            </span><span class="hs-special">,</span><span> </span><a href="Data.MultiSet.html#partition"><span class="hs-identifier hs-var">partition</span></a><span>
</span><a name="line-76"></a><span>            </span><span class="hs-special">,</span><span> </span><a href="Data.MultiSet.html#split"><span class="hs-identifier hs-var">split</span></a><span>
</span><a name="line-77"></a><span>            </span><span class="hs-special">,</span><span> </span><a href="Data.MultiSet.html#splitOccur"><span class="hs-identifier hs-var">splitOccur</span></a><span>
</span><a name="line-78"></a><span>
</span><a name="line-79"></a><span>            </span><span class="hs-comment">-- * Map</span><span>
</span><a name="line-80"></a><span>            </span><span class="hs-special">,</span><span> </span><a href="Data.MultiSet.html#map"><span class="hs-identifier hs-var">map</span></a><span>
</span><a name="line-81"></a><span>            </span><span class="hs-special">,</span><span> </span><a href="Data.MultiSet.html#mapMonotonic"><span class="hs-identifier hs-var">mapMonotonic</span></a><span>
</span><a name="line-82"></a><span>            </span><span class="hs-special">,</span><span> </span><a href="Data.MultiSet.html#mapMaybe"><span class="hs-identifier hs-var">mapMaybe</span></a><span>
</span><a name="line-83"></a><span>            </span><span class="hs-special">,</span><span> </span><a href="Data.MultiSet.html#mapEither"><span class="hs-identifier hs-var">mapEither</span></a><span>
</span><a name="line-84"></a><span>            </span><span class="hs-special">,</span><span> </span><a href="Data.MultiSet.html#concatMap"><span class="hs-identifier hs-var">concatMap</span></a><span>
</span><a name="line-85"></a><span>            </span><span class="hs-special">,</span><span> </span><a href="Data.MultiSet.html#unionsMap"><span class="hs-identifier hs-var">unionsMap</span></a><span>
</span><a name="line-86"></a><span>
</span><a name="line-87"></a><span>            </span><span class="hs-comment">-- * Monadic</span><span>
</span><a name="line-88"></a><span>            </span><span class="hs-special">,</span><span> </span><a href="Data.MultiSet.html#bind"><span class="hs-identifier hs-var">bind</span></a><span>
</span><a name="line-89"></a><span>            </span><span class="hs-special">,</span><span> </span><a href="Data.MultiSet.html#join"><span class="hs-identifier hs-var">join</span></a><span>
</span><a name="line-90"></a><span>
</span><a name="line-91"></a><span>            </span><span class="hs-comment">-- * Fold</span><span>
</span><a name="line-92"></a><span>            </span><span class="hs-special">,</span><span> </span><a href="Data.MultiSet.html#fold"><span class="hs-identifier hs-var">fold</span></a><span>
</span><a name="line-93"></a><span>            </span><span class="hs-special">,</span><span> </span><a href="Data.MultiSet.html#foldOccur"><span class="hs-identifier hs-var">foldOccur</span></a><span>
</span><a name="line-94"></a><span>
</span><a name="line-95"></a><span>            </span><span class="hs-comment">-- * Min\/Max</span><span>
</span><a name="line-96"></a><span>            </span><span class="hs-special">,</span><span> </span><a href="Data.MultiSet.html#findMin"><span class="hs-identifier hs-var">findMin</span></a><span>
</span><a name="line-97"></a><span>            </span><span class="hs-special">,</span><span> </span><a href="Data.MultiSet.html#findMax"><span class="hs-identifier hs-var">findMax</span></a><span>
</span><a name="line-98"></a><span>            </span><span class="hs-special">,</span><span> </span><a href="Data.MultiSet.html#deleteMin"><span class="hs-identifier hs-var">deleteMin</span></a><span>
</span><a name="line-99"></a><span>            </span><span class="hs-special">,</span><span> </span><a href="Data.MultiSet.html#deleteMax"><span class="hs-identifier hs-var">deleteMax</span></a><span>
</span><a name="line-100"></a><span>            </span><span class="hs-special">,</span><span> </span><a href="Data.MultiSet.html#deleteMinAll"><span class="hs-identifier hs-var">deleteMinAll</span></a><span>
</span><a name="line-101"></a><span>            </span><span class="hs-special">,</span><span> </span><a href="Data.MultiSet.html#deleteMaxAll"><span class="hs-identifier hs-var">deleteMaxAll</span></a><span>
</span><a name="line-102"></a><span>            </span><span class="hs-special">,</span><span> </span><a href="Data.MultiSet.html#deleteFindMin"><span class="hs-identifier hs-var">deleteFindMin</span></a><span>
</span><a name="line-103"></a><span>            </span><span class="hs-special">,</span><span> </span><a href="Data.MultiSet.html#deleteFindMax"><span class="hs-identifier hs-var">deleteFindMax</span></a><span>
</span><a name="line-104"></a><span>            </span><span class="hs-special">,</span><span> </span><a href="Data.MultiSet.html#maxView"><span class="hs-identifier hs-var">maxView</span></a><span>
</span><a name="line-105"></a><span>            </span><span class="hs-special">,</span><span> </span><a href="Data.MultiSet.html#minView"><span class="hs-identifier hs-var">minView</span></a><span>
</span><a name="line-106"></a><span>
</span><a name="line-107"></a><span>            </span><span class="hs-comment">-- * Conversion</span><span>
</span><a name="line-108"></a><span>
</span><a name="line-109"></a><span>            </span><span class="hs-comment">-- ** List</span><span>
</span><a name="line-110"></a><span>            </span><span class="hs-special">,</span><span> </span><a href="Data.MultiSet.html#elems"><span class="hs-identifier hs-var">elems</span></a><span>
</span><a name="line-111"></a><span>            </span><span class="hs-special">,</span><span> </span><a href="Data.MultiSet.html#distinctElems"><span class="hs-identifier hs-var">distinctElems</span></a><span>
</span><a name="line-112"></a><span>            </span><span class="hs-special">,</span><span> </span><a href="Data.MultiSet.html#toList"><span class="hs-identifier hs-var">toList</span></a><span>
</span><a name="line-113"></a><span>            </span><span class="hs-special">,</span><span> </span><a href="Data.MultiSet.html#fromList"><span class="hs-identifier hs-var">fromList</span></a><span>
</span><a name="line-114"></a><span>
</span><a name="line-115"></a><span>            </span><span class="hs-comment">-- ** Ordered list</span><span>
</span><a name="line-116"></a><span>            </span><span class="hs-special">,</span><span> </span><a href="Data.MultiSet.html#toAscList"><span class="hs-identifier hs-var">toAscList</span></a><span>
</span><a name="line-117"></a><span>            </span><span class="hs-special">,</span><span> </span><a href="Data.MultiSet.html#fromAscList"><span class="hs-identifier hs-var">fromAscList</span></a><span>
</span><a name="line-118"></a><span>            </span><span class="hs-special">,</span><span> </span><a href="Data.MultiSet.html#fromDistinctAscList"><span class="hs-identifier hs-var">fromDistinctAscList</span></a><span>
</span><a name="line-119"></a><span>
</span><a name="line-120"></a><span>            </span><span class="hs-comment">-- ** Occurrence lists</span><span>
</span><a name="line-121"></a><span>            </span><span class="hs-special">,</span><span> </span><a href="Data.MultiSet.html#toOccurList"><span class="hs-identifier hs-var">toOccurList</span></a><span>
</span><a name="line-122"></a><span>            </span><span class="hs-special">,</span><span> </span><a href="Data.MultiSet.html#toAscOccurList"><span class="hs-identifier hs-var">toAscOccurList</span></a><span>
</span><a name="line-123"></a><span>            </span><span class="hs-special">,</span><span> </span><a href="Data.MultiSet.html#fromOccurList"><span class="hs-identifier hs-var">fromOccurList</span></a><span>
</span><a name="line-124"></a><span>            </span><span class="hs-special">,</span><span> </span><a href="Data.MultiSet.html#fromAscOccurList"><span class="hs-identifier hs-var">fromAscOccurList</span></a><span>
</span><a name="line-125"></a><span>            </span><span class="hs-special">,</span><span> </span><a href="Data.MultiSet.html#fromDistinctAscOccurList"><span class="hs-identifier hs-var">fromDistinctAscOccurList</span></a><span>
</span><a name="line-126"></a><span>
</span><a name="line-127"></a><span>            </span><span class="hs-comment">-- ** Map</span><span>
</span><a name="line-128"></a><span>            </span><span class="hs-special">,</span><span> </span><a href="Data.MultiSet.html#toMap"><span class="hs-identifier hs-var">toMap</span></a><span>
</span><a name="line-129"></a><span>            </span><span class="hs-special">,</span><span> </span><a href="Data.MultiSet.html#fromMap"><span class="hs-identifier hs-var">fromMap</span></a><span>
</span><a name="line-130"></a><span>            </span><span class="hs-special">,</span><span> </span><a href="Data.MultiSet.html#fromOccurMap"><span class="hs-identifier hs-var">fromOccurMap</span></a><span>
</span><a name="line-131"></a><span>
</span><a name="line-132"></a><span>            </span><span class="hs-comment">-- ** Set</span><span>
</span><a name="line-133"></a><span>            </span><span class="hs-special">,</span><span> </span><a href="Data.MultiSet.html#toSet"><span class="hs-identifier hs-var">toSet</span></a><span>
</span><a name="line-134"></a><span>            </span><span class="hs-special">,</span><span> </span><a href="Data.MultiSet.html#fromSet"><span class="hs-identifier hs-var">fromSet</span></a><span>
</span><a name="line-135"></a><span>
</span><a name="line-136"></a><span>            </span><span class="hs-comment">-- * Debugging</span><span>
</span><a name="line-137"></a><span>            </span><span class="hs-special">,</span><span> </span><a href="Data.MultiSet.html#showTree"><span class="hs-identifier hs-var">showTree</span></a><span>
</span><a name="line-138"></a><span>            </span><span class="hs-special">,</span><span> </span><a href="Data.MultiSet.html#showTreeWith"><span class="hs-identifier hs-var">showTreeWith</span></a><span>
</span><a name="line-139"></a><span>            </span><span class="hs-special">,</span><span> </span><a href="Data.MultiSet.html#valid"><span class="hs-identifier hs-var">valid</span></a><span>
</span><a name="line-140"></a><span>            </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-141"></a><span>
</span><a name="line-142"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Prelude</span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">filter</span><span class="hs-special">,</span><span class="hs-identifier hs-var">foldr</span><span class="hs-special">,</span><span class="hs-identifier hs-var">null</span><span class="hs-special">,</span><span class="hs-identifier hs-var">map</span><span class="hs-special">,</span><span class="hs-identifier hs-var">concatMap</span><span class="hs-special">)</span><span>
</span><a name="line-143"></a><span class="hs-cpp">#if __GLASGOW_HASKELL__ &lt; 710</span><span>
</span><a name="line-144"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Monoid</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Monoid</span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-145"></a><span class="hs-cpp">#endif</span><span>
</span><a name="line-146"></a><span class="hs-cpp">#if MIN_VERSION_base(4,11,0)</span><span>
</span><a name="line-147"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">List</span><span class="hs-operator">.</span><span class="hs-identifier">NonEmpty</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">toList</span><span class="hs-special">)</span><span>
</span><a name="line-148"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Semigroup</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Semigroup</span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">stimesIdempotentMonoid</span><span class="hs-special">)</span><span>
</span><a name="line-149"></a><span class="hs-cpp">#endif</span><span>
</span><a name="line-150"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Typeable</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-151"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Foldable</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">Foldable</span><span>
</span><a name="line-152"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Map</span><span class="hs-operator">.</span><span class="hs-identifier">Strict</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Map</span><span class="hs-special">)</span><span>
</span><a name="line-153"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Set</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Set</span><span class="hs-special">)</span><span>
</span><a name="line-154"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Map</span><span class="hs-operator">.</span><span class="hs-identifier">Strict</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">Map</span><span>
</span><a name="line-155"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Set</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">Set</span><span>
</span><a name="line-156"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">List</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">List</span><span>
</span><a name="line-157"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Control</span><span class="hs-operator">.</span><span class="hs-identifier">DeepSeq</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">NFData</span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-158"></a><span>
</span><a name="line-159"></a><span class="hs-comment">{-
-- just for testing
import QuickCheck 
import List (nub,sort)
import qualified List
-}</span><span>
</span><a name="line-165"></a><span>
</span><a name="line-166"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Typeable</span><span>
</span><a name="line-167"></a><span class="hs-cpp">#if __GLASGOW_HASKELL__</span><span>
</span><a name="line-168"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Text</span><span class="hs-operator">.</span><span class="hs-identifier">Read</span><span>
</span><a name="line-169"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Data</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Data</span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">mkNoRepType</span><span class="hs-special">)</span><span>
</span><a name="line-170"></a><span class="hs-cpp">#endif</span><span>
</span><a name="line-171"></a><span>
</span><a name="line-172"></a><span class="hs-comment">{--------------------------------------------------------------------
  Operators
--------------------------------------------------------------------}</span><span>
</span><a name="line-175"></a><span class="hs-keyword">infixl</span><span> </span><span class="hs-number">9</span><span> </span><span class="hs-operator">\\</span><span> </span><span class="hs-comment">--</span><span>
</span><a name="line-176"></a><span>
</span><a name="line-177"></a><span class="hs-comment">-- | /O(n+m)/. See 'difference'.</span><span>
</span><a name="line-178"></a><span class="hs-special">(</span><span class="hs-operator">\\</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Ord</span><span> </span><a href="#local-6989586621679032989"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Data.MultiSet.html#MultiSet"><span class="hs-identifier hs-type">MultiSet</span></a><span> </span><a href="#local-6989586621679032989"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.MultiSet.html#MultiSet"><span class="hs-identifier hs-type">MultiSet</span></a><span> </span><a href="#local-6989586621679032989"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.MultiSet.html#MultiSet"><span class="hs-identifier hs-type">MultiSet</span></a><span> </span><a href="#local-6989586621679032989"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-179"></a><a name="local-6989586621679032990"><a href="#local-6989586621679032990"><span class="hs-identifier">m1</span></a></a><span> </span><a name="%5C%5C"><a href="Data.MultiSet.html#%5C%5C"><span class="hs-operator">\\</span></a></a><span> </span><a name="local-6989586621679032991"><a href="#local-6989586621679032991"><span class="hs-identifier">m2</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.MultiSet.html#difference"><span class="hs-identifier hs-var">difference</span></a><span> </span><a href="#local-6989586621679032990"><span class="hs-identifier hs-var">m1</span></a><span> </span><a href="#local-6989586621679032991"><span class="hs-identifier hs-var">m2</span></a><span>
</span><a name="line-180"></a><span>
</span><a name="line-181"></a><span class="hs-comment">{--------------------------------------------------------------------
  The data type
--------------------------------------------------------------------}</span><span>
</span><a name="line-184"></a><span>
</span><a name="line-185"></a><span class="hs-comment">-- | A multiset of values @a@.</span><span>
</span><a name="line-186"></a><span class="hs-comment">--   The same value can occur multiple times.</span><span>
</span><a name="line-187"></a><span class="hs-keyword">newtype</span><span> </span><a name="MultiSet"><a href="Data.MultiSet.html#MultiSet"><span class="hs-identifier">MultiSet</span></a></a><span> </span><a name="local-6989586621679031150"><a href="#local-6989586621679031150"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="MS"><a href="Data.MultiSet.html#MS"><span class="hs-identifier">MS</span></a></a><span> </span><span class="hs-special">{</span><span> </span><a name="unMS"><a href="Data.MultiSet.html#unMS"><span class="hs-identifier">unMS</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Map</span><span> </span><a href="#local-6989586621679031150"><span class="hs-identifier hs-type">a</span></a><span> </span><a href="Data.MultiSet.html#Occur"><span class="hs-identifier hs-type">Occur</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-188"></a><span>                     </span><span class="hs-comment">-- invariant: all values in the map are &gt;= 1</span><span>
</span><a name="line-189"></a><span>
</span><a name="line-190"></a><span class="hs-comment">-- | The number of occurrences of an element</span><span>
</span><a name="line-191"></a><span class="hs-keyword">type</span><span> </span><a name="Occur"><a href="Data.MultiSet.html#Occur"><span class="hs-identifier">Occur</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-type">Int</span><span>
</span><a name="line-192"></a><span>
</span><a name="line-193"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Ord</span><span> </span><a href="#local-6989586621679032388"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">Monoid</span><span> </span><span class="hs-special">(</span><a href="Data.MultiSet.html#MultiSet"><span class="hs-identifier hs-type">MultiSet</span></a><span> </span><a href="#local-6989586621679032388"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-194"></a><span>    </span><a name="local-3458764513820541483"><span class="hs-identifier">mempty</span></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Data.MultiSet.html#empty"><span class="hs-identifier hs-var">empty</span></a><span>
</span><a name="line-195"></a><span>    </span><a name="local-3458764513820541484"><span class="hs-identifier">mappend</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.MultiSet.html#union"><span class="hs-identifier hs-var">union</span></a><span>
</span><a name="line-196"></a><span>    </span><a name="local-3458764513820541485"><span class="hs-identifier">mconcat</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.MultiSet.html#unions"><span class="hs-identifier hs-var">unions</span></a><span>
</span><a name="line-197"></a><span>
</span><a name="line-198"></a><span class="hs-cpp">#if MIN_VERSION_base(4,11,0)</span><span>
</span><a name="line-199"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier">Ord</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier">Semigroup</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">MultiSet</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-200"></a><span>    </span><span class="hs-special">(</span><span class="hs-operator">&lt;&gt;</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">union</span><span>
</span><a name="line-201"></a><span>    </span><span class="hs-identifier">sconcat</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">unions</span><span> </span><span class="hs-operator">.</span><span> </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">List</span><span class="hs-operator">.</span><span class="hs-identifier">NonEmpty</span><span class="hs-operator">.</span><span class="hs-identifier">toList</span><span>
</span><a name="line-202"></a><span>    </span><span class="hs-identifier">stimes</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">stimesIdempotentMonoid</span><span>
</span><a name="line-203"></a><span class="hs-cpp">#endif</span><span>
</span><a name="line-204"></a><span>
</span><a name="line-205"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Foldable</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">Foldable</span><span> </span><a href="Data.MultiSet.html#MultiSet"><span class="hs-identifier hs-type">MultiSet</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-206"></a><span>    </span><a name="local-8214565720323788895"><span class="hs-identifier">foldr</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.MultiSet.html#fold"><span class="hs-identifier hs-var">fold</span></a><span>
</span><a name="line-207"></a><span>
</span><a name="line-208"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">NFData</span><span> </span><a href="#local-6989586621679032387"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">NFData</span><span> </span><span class="hs-special">(</span><a href="Data.MultiSet.html#MultiSet"><span class="hs-identifier hs-type">MultiSet</span></a><span> </span><a href="#local-6989586621679032387"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-209"></a><span>    </span><a name="local-8214565720323791624"><span class="hs-identifier">rnf</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">rnf</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier">unMS</span><span>
</span><a name="line-210"></a><span>
</span><a name="line-211"></a><span class="hs-cpp">#if __GLASGOW_HASKELL__</span><span>
</span><a name="line-212"></a><span>
</span><a name="line-213"></a><span class="hs-comment">{--------------------------------------------------------------------
  A Data instance  
--------------------------------------------------------------------}</span><span>
</span><a name="line-216"></a><span>
</span><a name="line-217"></a><span class="hs-comment">-- This instance preserves data abstraction at the cost of inefficiency.</span><span>
</span><a name="line-218"></a><span class="hs-comment">-- We omit reflection services for the sake of data abstraction.</span><span>
</span><a name="line-219"></a><span>
</span><a name="line-220"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Data</span><span> </span><a href="#local-6989586621679032368"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Ord</span><span> </span><a href="#local-6989586621679032368"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">Data</span><span> </span><span class="hs-special">(</span><a href="Data.MultiSet.html#MultiSet"><span class="hs-identifier hs-type">MultiSet</span></a><span> </span><a href="#local-6989586621679032368"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-221"></a><span>  </span><a name="local-8214565720323786758"><span class="hs-identifier">gfoldl</span></a><span> </span><a name="local-6989586621679032369"><a href="#local-6989586621679032369"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679032370"><a href="#local-6989586621679032370"><span class="hs-identifier">z</span></a></a><span> </span><a name="local-6989586621679032371"><a href="#local-6989586621679032371"><span class="hs-identifier">set</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679032370"><span class="hs-identifier hs-var">z</span></a><span> </span><a href="Data.MultiSet.html#fromList"><span class="hs-identifier hs-var">fromList</span></a><span> </span><span class="hs-special">`</span><a href="#local-6989586621679032369"><span class="hs-identifier hs-var">f</span></a><span class="hs-special">`</span><span> </span><span class="hs-special">(</span><a href="Data.MultiSet.html#toList"><span class="hs-identifier hs-var">toList</span></a><span> </span><a href="#local-6989586621679032371"><span class="hs-identifier hs-var">set</span></a><span class="hs-special">)</span><span>
</span><a name="line-222"></a><span>  </span><a name="local-8214565720323786756"><span class="hs-identifier">toConstr</span></a><span> </span><span class="hs-identifier">_</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">error</span><span> </span><span class="hs-string">&quot;toConstr&quot;</span><span>
</span><a name="line-223"></a><span>  </span><a name="local-8214565720323786757"><span class="hs-identifier">gunfold</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">error</span><span> </span><span class="hs-string">&quot;gunfold&quot;</span><span>
</span><a name="line-224"></a><span>  </span><a name="local-8214565720323786755"><span class="hs-identifier">dataTypeOf</span></a><span> </span><span class="hs-identifier">_</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">mkNoRepType</span><span> </span><span class="hs-string">&quot;Data.MultiSet.MultiSet&quot;</span><span>
</span><a name="line-225"></a><span>  </span><a name="local-8214565720323786754"><span class="hs-identifier">dataCast1</span></a><span> </span><a name="local-6989586621679032386"><a href="#local-6989586621679032386"><span class="hs-identifier">f</span></a></a><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">gcast1</span><span> </span><a href="#local-6989586621679032386"><span class="hs-identifier hs-var">f</span></a><span>
</span><a name="line-226"></a><span>
</span><a name="line-227"></a><span class="hs-cpp">#endif</span><span>
</span><a name="line-228"></a><span>
</span><a name="line-229"></a><span class="hs-comment">{--------------------------------------------------------------------
  Query
--------------------------------------------------------------------}</span><span>
</span><a name="line-232"></a><span>
</span><a name="line-233"></a><span class="hs-comment">-- | /O(1)/. Is this the empty multiset?</span><span>
</span><a name="line-234"></a><span class="hs-identifier">null</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.MultiSet.html#MultiSet"><span class="hs-identifier hs-type">MultiSet</span></a><span> </span><a href="#local-6989586621679032988"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-235"></a><a name="null"><a href="Data.MultiSet.html#null"><span class="hs-identifier">null</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Map</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">null</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier">unMS</span><span>
</span><a name="line-236"></a><span>
</span><a name="line-237"></a><span class="hs-comment">-- | /O(n)/. The number of elements in the multiset.</span><span>
</span><a name="line-238"></a><span class="hs-identifier">size</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.MultiSet.html#MultiSet"><span class="hs-identifier hs-type">MultiSet</span></a><span> </span><a href="#local-6989586621679032987"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.MultiSet.html#Occur"><span class="hs-identifier hs-type">Occur</span></a><span>
</span><a name="line-239"></a><a name="size"><a href="Data.MultiSet.html#size"><span class="hs-identifier">size</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">sum</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">Map</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">elems</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier">unMS</span><span>
</span><a name="line-240"></a><span>
</span><a name="line-241"></a><span class="hs-comment">-- | /O(1)/. The number of distinct elements in the multiset.</span><span>
</span><a name="line-242"></a><span class="hs-identifier">distinctSize</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.MultiSet.html#MultiSet"><span class="hs-identifier hs-type">MultiSet</span></a><span> </span><a href="#local-6989586621679032986"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.MultiSet.html#Occur"><span class="hs-identifier hs-type">Occur</span></a><span>
</span><a name="line-243"></a><a name="distinctSize"><a href="Data.MultiSet.html#distinctSize"><span class="hs-identifier">distinctSize</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Map</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">size</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier">unMS</span><span>
</span><a name="line-244"></a><span>
</span><a name="line-245"></a><span class="hs-comment">-- | /O(log n)/. Is the element in the multiset?</span><span>
</span><a name="line-246"></a><span class="hs-identifier">member</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Ord</span><span> </span><a href="#local-6989586621679032985"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="#local-6989586621679032985"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.MultiSet.html#MultiSet"><span class="hs-identifier hs-type">MultiSet</span></a><span> </span><a href="#local-6989586621679032985"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-247"></a><a name="member"><a href="Data.MultiSet.html#member"><span class="hs-identifier">member</span></a></a><span> </span><a name="local-6989586621679032992"><a href="#local-6989586621679032992"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Map</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">member</span><span> </span><a href="#local-6989586621679032992"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier">unMS</span><span>
</span><a name="line-248"></a><span>
</span><a name="line-249"></a><span class="hs-comment">-- | /O(log n)/. Is the element not in the multiset?</span><span>
</span><a name="line-250"></a><span class="hs-identifier">notMember</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Ord</span><span> </span><a href="#local-6989586621679032984"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="#local-6989586621679032984"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.MultiSet.html#MultiSet"><span class="hs-identifier hs-type">MultiSet</span></a><span> </span><a href="#local-6989586621679032984"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-251"></a><a name="notMember"><a href="Data.MultiSet.html#notMember"><span class="hs-identifier">notMember</span></a></a><span> </span><a name="local-6989586621679032993"><a href="#local-6989586621679032993"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">not</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Data.MultiSet.html#member"><span class="hs-identifier hs-var">member</span></a><span> </span><a href="#local-6989586621679032993"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-252"></a><span>
</span><a name="line-253"></a><span class="hs-comment">-- | /O(log n)/. The number of occurrences of an element in a multiset.</span><span>
</span><a name="line-254"></a><span class="hs-identifier">occur</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Ord</span><span> </span><a href="#local-6989586621679032983"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="#local-6989586621679032983"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.MultiSet.html#MultiSet"><span class="hs-identifier hs-type">MultiSet</span></a><span> </span><a href="#local-6989586621679032983"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.MultiSet.html#Occur"><span class="hs-identifier hs-type">Occur</span></a><span>
</span><a name="line-255"></a><a name="occur"><a href="Data.MultiSet.html#occur"><span class="hs-identifier">occur</span></a></a><span> </span><a name="local-6989586621679032994"><a href="#local-6989586621679032994"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Map</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">findWithDefault</span><span> </span><span class="hs-number">0</span><span> </span><a href="#local-6989586621679032994"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier">unMS</span><span>
</span><a name="line-256"></a><span>
</span><a name="line-257"></a><span class="hs-comment">{--------------------------------------------------------------------
  Construction
--------------------------------------------------------------------}</span><span>
</span><a name="line-260"></a><span>
</span><a name="line-261"></a><span class="hs-comment">-- | /O(1)/. The empty mutli set.</span><span>
</span><a name="line-262"></a><span class="hs-identifier">empty</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.MultiSet.html#MultiSet"><span class="hs-identifier hs-type">MultiSet</span></a><span> </span><a href="#local-6989586621679032982"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-263"></a><a name="empty"><a href="Data.MultiSet.html#empty"><span class="hs-identifier">empty</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.MultiSet.html#MS"><span class="hs-identifier hs-var">MS</span></a><span> </span><span class="hs-identifier hs-var">Map</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">empty</span><span>
</span><a name="line-264"></a><span>
</span><a name="line-265"></a><span class="hs-comment">-- | /O(1)/. Create a singleton mutli set.</span><span>
</span><a name="line-266"></a><span class="hs-identifier">singleton</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="#local-6989586621679032981"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.MultiSet.html#MultiSet"><span class="hs-identifier hs-type">MultiSet</span></a><span> </span><a href="#local-6989586621679032981"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-267"></a><a name="singleton"><a href="Data.MultiSet.html#singleton"><span class="hs-identifier">singleton</span></a></a><span> </span><a name="local-6989586621679033100"><a href="#local-6989586621679033100"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.MultiSet.html#MS"><span class="hs-identifier hs-var">MS</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Map</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">singleton</span><span> </span><a href="#local-6989586621679033100"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span>
</span><a name="line-268"></a><span>
</span><a name="line-269"></a><span class="hs-comment">{--------------------------------------------------------------------
  Insertion, Deletion
--------------------------------------------------------------------}</span><span>
</span><a name="line-272"></a><span>
</span><a name="line-273"></a><span class="hs-comment">-- | /O(log n)/. Insert an element in a multiset.</span><span>
</span><a name="line-274"></a><span class="hs-identifier">insert</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Ord</span><span> </span><a href="#local-6989586621679032980"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="#local-6989586621679032980"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.MultiSet.html#MultiSet"><span class="hs-identifier hs-type">MultiSet</span></a><span> </span><a href="#local-6989586621679032980"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.MultiSet.html#MultiSet"><span class="hs-identifier hs-type">MultiSet</span></a><span> </span><a href="#local-6989586621679032980"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-275"></a><a name="insert"><a href="Data.MultiSet.html#insert"><span class="hs-identifier">insert</span></a></a><span> </span><a name="local-6989586621679033101"><a href="#local-6989586621679033101"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.MultiSet.html#MS"><span class="hs-identifier hs-var">MS</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">Map</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">insertWith</span><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">+</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679033101"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-number">1</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier">unMS</span><span>
</span><a name="line-276"></a><span>
</span><a name="line-277"></a><span class="hs-comment">-- | /O(log n)/. Insert an element in a multiset a given number of times.</span><span>
</span><a name="line-278"></a><span class="hs-comment">--</span><span>
</span><a name="line-279"></a><span class="hs-comment">-- Negative numbers remove occurrences of the given element.</span><span>
</span><a name="line-280"></a><span class="hs-identifier">insertMany</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Ord</span><span> </span><a href="#local-6989586621679032979"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="#local-6989586621679032979"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.MultiSet.html#Occur"><span class="hs-identifier hs-type">Occur</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.MultiSet.html#MultiSet"><span class="hs-identifier hs-type">MultiSet</span></a><span> </span><a href="#local-6989586621679032979"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.MultiSet.html#MultiSet"><span class="hs-identifier hs-type">MultiSet</span></a><span> </span><a href="#local-6989586621679032979"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-281"></a><a name="insertMany"><a href="Data.MultiSet.html#insertMany"><span class="hs-identifier">insertMany</span></a></a><span> </span><a name="local-6989586621679033181"><a href="#local-6989586621679033181"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679033182"><a href="#local-6989586621679033182"><span class="hs-identifier">n</span></a></a><span>
</span><a name="line-282"></a><span> </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679033182"><span class="hs-identifier hs-var">n</span></a><span> </span><span class="hs-operator hs-var">&lt;</span><span>  </span><span class="hs-number">0</span><span>    </span><span class="hs-glyph">=</span><span> </span><a href="Data.MultiSet.html#MS"><span class="hs-identifier hs-var">MS</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">Map</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">update</span><span> </span><span class="hs-special">(</span><a href="Data.MultiSet.html#deleteN"><span class="hs-identifier hs-var">deleteN</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">negate</span><span> </span><a href="#local-6989586621679033182"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679033181"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier">unMS</span><span>
</span><a name="line-283"></a><span> </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679033182"><span class="hs-identifier hs-var">n</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-number">0</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">id</span><span>
</span><a name="line-284"></a><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.MultiSet.html#MS"><span class="hs-identifier hs-var">MS</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">Map</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">insertWith</span><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">+</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679033181"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679033182"><span class="hs-identifier hs-var">n</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier">unMS</span><span>
</span><a name="line-285"></a><span>
</span><a name="line-286"></a><span class="hs-comment">-- | /O(log n)/. Delete a single element from a multiset.</span><span>
</span><a name="line-287"></a><span class="hs-identifier">delete</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Ord</span><span> </span><a href="#local-6989586621679032978"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="#local-6989586621679032978"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.MultiSet.html#MultiSet"><span class="hs-identifier hs-type">MultiSet</span></a><span> </span><a href="#local-6989586621679032978"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.MultiSet.html#MultiSet"><span class="hs-identifier hs-type">MultiSet</span></a><span> </span><a href="#local-6989586621679032978"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-288"></a><a name="delete"><a href="Data.MultiSet.html#delete"><span class="hs-identifier">delete</span></a></a><span> </span><a name="local-6989586621679033183"><a href="#local-6989586621679033183"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.MultiSet.html#MS"><span class="hs-identifier hs-var">MS</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">Map</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">update</span><span> </span><span class="hs-special">(</span><a href="Data.MultiSet.html#deleteN"><span class="hs-identifier hs-var">deleteN</span></a><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679033183"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier">unMS</span><span>
</span><a name="line-289"></a><span>
</span><a name="line-290"></a><span class="hs-comment">-- | /O(log n)/. Delete an element from a multiset a given number of times.</span><span>
</span><a name="line-291"></a><span class="hs-comment">--</span><span>
</span><a name="line-292"></a><span class="hs-comment">-- Negative numbers add occurrences of the given element.</span><span>
</span><a name="line-293"></a><span class="hs-identifier">deleteMany</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Ord</span><span> </span><a href="#local-6989586621679032977"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="#local-6989586621679032977"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.MultiSet.html#Occur"><span class="hs-identifier hs-type">Occur</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.MultiSet.html#MultiSet"><span class="hs-identifier hs-type">MultiSet</span></a><span> </span><a href="#local-6989586621679032977"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.MultiSet.html#MultiSet"><span class="hs-identifier hs-type">MultiSet</span></a><span> </span><a href="#local-6989586621679032977"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-294"></a><a name="deleteMany"><a href="Data.MultiSet.html#deleteMany"><span class="hs-identifier">deleteMany</span></a></a><span> </span><a name="local-6989586621679033184"><a href="#local-6989586621679033184"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679033185"><a href="#local-6989586621679033185"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.MultiSet.html#insertMany"><span class="hs-identifier hs-var">insertMany</span></a><span> </span><a href="#local-6989586621679033184"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">negate</span><span> </span><a href="#local-6989586621679033185"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">)</span><span>
</span><a name="line-295"></a><span>
</span><a name="line-296"></a><span class="hs-comment">-- | /O(log n)/. Delete all occurrences of an element from a multiset.</span><span>
</span><a name="line-297"></a><span class="hs-identifier">deleteAll</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Ord</span><span> </span><a href="#local-6989586621679032976"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="#local-6989586621679032976"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.MultiSet.html#MultiSet"><span class="hs-identifier hs-type">MultiSet</span></a><span> </span><a href="#local-6989586621679032976"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.MultiSet.html#MultiSet"><span class="hs-identifier hs-type">MultiSet</span></a><span> </span><a href="#local-6989586621679032976"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-298"></a><a name="deleteAll"><a href="Data.MultiSet.html#deleteAll"><span class="hs-identifier">deleteAll</span></a></a><span> </span><a name="local-6989586621679033186"><a href="#local-6989586621679033186"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.MultiSet.html#MS"><span class="hs-identifier hs-var">MS</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">Map</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">delete</span><span> </span><a href="#local-6989586621679033186"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier">unMS</span><span>
</span><a name="line-299"></a><span>
</span><a name="line-300"></a><span class="hs-identifier">deleteN</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.MultiSet.html#Occur"><span class="hs-identifier hs-type">Occur</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.MultiSet.html#Occur"><span class="hs-identifier hs-type">Occur</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="Data.MultiSet.html#Occur"><span class="hs-identifier hs-type">Occur</span></a><span>
</span><a name="line-301"></a><a name="deleteN"><a href="Data.MultiSet.html#deleteN"><span class="hs-identifier">deleteN</span></a></a><span> </span><a name="local-6989586621679033187"><a href="#local-6989586621679033187"><span class="hs-identifier">n</span></a></a><span> </span><a name="local-6989586621679033188"><a href="#local-6989586621679033188"><span class="hs-identifier">m</span></a></a><span>
</span><a name="line-302"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679033188"><span class="hs-identifier hs-var">m</span></a><span> </span><span class="hs-operator hs-var">&lt;=</span><span> </span><a href="#local-6989586621679033187"><span class="hs-identifier hs-var">n</span></a><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-303"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679033188"><span class="hs-identifier hs-var">m</span></a><span> </span><span class="hs-glyph">-</span><span> </span><a href="#local-6989586621679033187"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">)</span><span>
</span><a name="line-304"></a><span>
</span><a name="line-305"></a><span>
</span><a name="line-306"></a><span class="hs-comment">{--------------------------------------------------------------------
  Subset
--------------------------------------------------------------------}</span><span>
</span><a name="line-309"></a><span>
</span><a name="line-310"></a><span class="hs-comment">-- | /O(n+m)/. Is this a proper subset? (ie. a subset but not equal).</span><span>
</span><a name="line-311"></a><span class="hs-identifier">isProperSubsetOf</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Ord</span><span> </span><a href="#local-6989586621679032975"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Data.MultiSet.html#MultiSet"><span class="hs-identifier hs-type">MultiSet</span></a><span> </span><a href="#local-6989586621679032975"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.MultiSet.html#MultiSet"><span class="hs-identifier hs-type">MultiSet</span></a><span> </span><a href="#local-6989586621679032975"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-312"></a><a name="isProperSubsetOf"><a href="Data.MultiSet.html#isProperSubsetOf"><span class="hs-identifier">isProperSubsetOf</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.MultiSet.html#MS"><span class="hs-identifier hs-var">MS</span></a><span> </span><a name="local-6989586621679033189"><a href="#local-6989586621679033189"><span class="hs-identifier">m1</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.MultiSet.html#MS"><span class="hs-identifier hs-var">MS</span></a><span> </span><a name="local-6989586621679033190"><a href="#local-6989586621679033190"><span class="hs-identifier">m2</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Map</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">isProperSubmapOfBy</span><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">&lt;=</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679033189"><span class="hs-identifier hs-var">m1</span></a><span> </span><a href="#local-6989586621679033190"><span class="hs-identifier hs-var">m2</span></a><span>
</span><a name="line-313"></a><span>
</span><a name="line-314"></a><span class="hs-comment">-- | /O(n+m)/. Is this a subset?</span><span>
</span><a name="line-315"></a><span class="hs-comment">-- @(s1 \`isSubsetOf\` s2)@ tells whether @s1@ is a subset of @s2@.</span><span>
</span><a name="line-316"></a><span class="hs-identifier">isSubsetOf</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Ord</span><span> </span><a href="#local-6989586621679032974"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Data.MultiSet.html#MultiSet"><span class="hs-identifier hs-type">MultiSet</span></a><span> </span><a href="#local-6989586621679032974"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.MultiSet.html#MultiSet"><span class="hs-identifier hs-type">MultiSet</span></a><span> </span><a href="#local-6989586621679032974"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-317"></a><a name="isSubsetOf"><a href="Data.MultiSet.html#isSubsetOf"><span class="hs-identifier">isSubsetOf</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.MultiSet.html#MS"><span class="hs-identifier hs-var">MS</span></a><span> </span><a name="local-6989586621679033191"><a href="#local-6989586621679033191"><span class="hs-identifier">m1</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.MultiSet.html#MS"><span class="hs-identifier hs-var">MS</span></a><span> </span><a name="local-6989586621679033192"><a href="#local-6989586621679033192"><span class="hs-identifier">m2</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Map</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">isSubmapOfBy</span><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">&lt;=</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679033191"><span class="hs-identifier hs-var">m1</span></a><span> </span><a href="#local-6989586621679033192"><span class="hs-identifier hs-var">m2</span></a><span>
</span><a name="line-318"></a><span>
</span><a name="line-319"></a><span class="hs-comment">{--------------------------------------------------------------------
  Minimal, Maximal
--------------------------------------------------------------------}</span><span>
</span><a name="line-322"></a><span>
</span><a name="line-323"></a><span class="hs-comment">-- | /O(log n)/. The minimal element of a multiset.</span><span>
</span><a name="line-324"></a><span class="hs-identifier">findMin</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.MultiSet.html#MultiSet"><span class="hs-identifier hs-type">MultiSet</span></a><span> </span><a href="#local-6989586621679032973"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679032973"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-325"></a><a name="findMin"><a href="Data.MultiSet.html#findMin"><span class="hs-identifier">findMin</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">fst</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">Map</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">findMin</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier">unMS</span><span>
</span><a name="line-326"></a><span>
</span><a name="line-327"></a><span class="hs-comment">-- | /O(log n)/. The maximal element of a multiset.</span><span>
</span><a name="line-328"></a><span class="hs-identifier">findMax</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.MultiSet.html#MultiSet"><span class="hs-identifier hs-type">MultiSet</span></a><span> </span><a href="#local-6989586621679032972"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679032972"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-329"></a><a name="findMax"><a href="Data.MultiSet.html#findMax"><span class="hs-identifier">findMax</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">fst</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">Map</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">findMax</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier">unMS</span><span>
</span><a name="line-330"></a><span>
</span><a name="line-331"></a><span class="hs-comment">-- | /O(log n)/. Delete the minimal element.</span><span>
</span><a name="line-332"></a><span class="hs-identifier">deleteMin</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.MultiSet.html#MultiSet"><span class="hs-identifier hs-type">MultiSet</span></a><span> </span><a href="#local-6989586621679032971"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.MultiSet.html#MultiSet"><span class="hs-identifier hs-type">MultiSet</span></a><span> </span><a href="#local-6989586621679032971"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-333"></a><a name="deleteMin"><a href="Data.MultiSet.html#deleteMin"><span class="hs-identifier">deleteMin</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.MultiSet.html#MS"><span class="hs-identifier hs-var">MS</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">Map</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">updateMin</span><span> </span><span class="hs-special">(</span><a href="Data.MultiSet.html#deleteN"><span class="hs-identifier hs-var">deleteN</span></a><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier">unMS</span><span>
</span><a name="line-334"></a><span>
</span><a name="line-335"></a><span class="hs-comment">-- | /O(log n)/. Delete the maximal element.</span><span>
</span><a name="line-336"></a><span class="hs-identifier">deleteMax</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.MultiSet.html#MultiSet"><span class="hs-identifier hs-type">MultiSet</span></a><span> </span><a href="#local-6989586621679032970"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.MultiSet.html#MultiSet"><span class="hs-identifier hs-type">MultiSet</span></a><span> </span><a href="#local-6989586621679032970"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-337"></a><a name="deleteMax"><a href="Data.MultiSet.html#deleteMax"><span class="hs-identifier">deleteMax</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.MultiSet.html#MS"><span class="hs-identifier hs-var">MS</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">Map</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">updateMax</span><span> </span><span class="hs-special">(</span><a href="Data.MultiSet.html#deleteN"><span class="hs-identifier hs-var">deleteN</span></a><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier">unMS</span><span>
</span><a name="line-338"></a><span>
</span><a name="line-339"></a><span class="hs-comment">-- | /O(log n)/. Delete all occurrences of the minimal element.</span><span>
</span><a name="line-340"></a><span class="hs-identifier">deleteMinAll</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.MultiSet.html#MultiSet"><span class="hs-identifier hs-type">MultiSet</span></a><span> </span><a href="#local-6989586621679032969"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.MultiSet.html#MultiSet"><span class="hs-identifier hs-type">MultiSet</span></a><span> </span><a href="#local-6989586621679032969"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-341"></a><a name="deleteMinAll"><a href="Data.MultiSet.html#deleteMinAll"><span class="hs-identifier">deleteMinAll</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.MultiSet.html#MS"><span class="hs-identifier hs-var">MS</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">Map</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">deleteMin</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier">unMS</span><span>
</span><a name="line-342"></a><span>
</span><a name="line-343"></a><span class="hs-comment">-- | /O(log n)/. Delete all occurrences of the maximal element.</span><span>
</span><a name="line-344"></a><span class="hs-identifier">deleteMaxAll</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.MultiSet.html#MultiSet"><span class="hs-identifier hs-type">MultiSet</span></a><span> </span><a href="#local-6989586621679032968"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.MultiSet.html#MultiSet"><span class="hs-identifier hs-type">MultiSet</span></a><span> </span><a href="#local-6989586621679032968"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-345"></a><a name="deleteMaxAll"><a href="Data.MultiSet.html#deleteMaxAll"><span class="hs-identifier">deleteMaxAll</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.MultiSet.html#MS"><span class="hs-identifier hs-var">MS</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">Map</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">deleteMax</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier">unMS</span><span>
</span><a name="line-346"></a><span>
</span><a name="line-347"></a><span class="hs-comment">-- | /O(log n)/. Delete and find the minimal element.</span><span>
</span><a name="line-348"></a><span class="hs-comment">-- </span><span>
</span><a name="line-349"></a><span class="hs-comment">-- &gt; deleteFindMin set = (findMin set, deleteMin set)</span><span>
</span><a name="line-350"></a><span class="hs-identifier">deleteFindMin</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.MultiSet.html#MultiSet"><span class="hs-identifier hs-type">MultiSet</span></a><span> </span><a href="#local-6989586621679032967"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679032967"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><a href="Data.MultiSet.html#MultiSet"><span class="hs-identifier hs-type">MultiSet</span></a><span> </span><a href="#local-6989586621679032967"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-351"></a><span class="hs-comment">-- TODO: add this missing function to Data.Map</span><span>
</span><a name="line-352"></a><span class="hs-comment">--deleteFindMin = (\((v,_),m) -&gt; (v, MS m)) . Map.updateFindMin (deleteN 1) . unMS</span><span>
</span><a name="line-353"></a><a name="deleteFindMin"><a href="Data.MultiSet.html#deleteFindMin"><span class="hs-identifier">deleteFindMin</span></a></a><span> </span><a name="local-6989586621679033208"><a href="#local-6989586621679033208"><span class="hs-identifier">set</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="Data.MultiSet.html#findMin"><span class="hs-identifier hs-var">findMin</span></a><span> </span><a href="#local-6989586621679033208"><span class="hs-identifier hs-var">set</span></a><span class="hs-special">,</span><span> </span><a href="Data.MultiSet.html#deleteMin"><span class="hs-identifier hs-var">deleteMin</span></a><span> </span><a href="#local-6989586621679033208"><span class="hs-identifier hs-var">set</span></a><span class="hs-special">)</span><span>
</span><a name="line-354"></a><span>
</span><a name="line-355"></a><span class="hs-comment">-- | /O(log n)/. Delete and find the maximal element.</span><span>
</span><a name="line-356"></a><span class="hs-comment">-- </span><span>
</span><a name="line-357"></a><span class="hs-comment">-- &gt; deleteFindMax set = (findMax set, deleteMax set)</span><span>
</span><a name="line-358"></a><span class="hs-identifier">deleteFindMax</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.MultiSet.html#MultiSet"><span class="hs-identifier hs-type">MultiSet</span></a><span> </span><a href="#local-6989586621679032966"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679032966"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><a href="Data.MultiSet.html#MultiSet"><span class="hs-identifier hs-type">MultiSet</span></a><span> </span><a href="#local-6989586621679032966"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-359"></a><span class="hs-comment">-- TODO: add this missing function to Data.Map</span><span>
</span><a name="line-360"></a><span class="hs-comment">--deleteFindMax = (\((v,_),m) -&gt; (v, MS m)) . Map.updateFindMax (deleteN 1) . unMS</span><span>
</span><a name="line-361"></a><a name="deleteFindMax"><a href="Data.MultiSet.html#deleteFindMax"><span class="hs-identifier">deleteFindMax</span></a></a><span> </span><a name="local-6989586621679033209"><a href="#local-6989586621679033209"><span class="hs-identifier">set</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="Data.MultiSet.html#findMax"><span class="hs-identifier hs-var">findMax</span></a><span> </span><a href="#local-6989586621679033209"><span class="hs-identifier hs-var">set</span></a><span class="hs-special">,</span><span> </span><a href="Data.MultiSet.html#deleteMax"><span class="hs-identifier hs-var">deleteMax</span></a><span> </span><a href="#local-6989586621679033209"><span class="hs-identifier hs-var">set</span></a><span class="hs-special">)</span><span>
</span><a name="line-362"></a><span>
</span><a name="line-363"></a><span class="hs-comment">-- | /O(log n)/. Retrieves the minimal element of the multiset,</span><span>
</span><a name="line-364"></a><span class="hs-comment">--   and the set with that element removed.</span><span>
</span><a name="line-365"></a><span class="hs-comment">--   Returns @Nothing@ when passed an empty multiset.</span><span>
</span><a name="line-366"></a><span class="hs-comment">--</span><span>
</span><a name="line-367"></a><span class="hs-comment">-- Examples:</span><span>
</span><a name="line-368"></a><span class="hs-comment">--</span><span>
</span><a name="line-369"></a><span class="hs-comment">-- &gt;&gt;&gt; minView $ fromList ['a', 'a', 'b', 'c']</span><span>
</span><a name="line-370"></a><span class="hs-comment">-- Just ('a',fromOccurList [('a',1),('b',1),('c',1)])</span><span>
</span><a name="line-371"></a><span class="hs-identifier">minView</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.MultiSet.html#MultiSet"><span class="hs-identifier hs-type">MultiSet</span></a><span> </span><a href="#local-6989586621679032965"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679032965"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><a href="Data.MultiSet.html#MultiSet"><span class="hs-identifier hs-type">MultiSet</span></a><span> </span><a href="#local-6989586621679032965"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-372"></a><a name="minView"><a href="Data.MultiSet.html#minView"><span class="hs-identifier">minView</span></a></a><span> </span><a name="local-6989586621679033210"><a href="#local-6989586621679033210"><span class="hs-identifier">x</span></a></a><span>
</span><a name="line-373"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="Data.MultiSet.html#null"><span class="hs-identifier hs-var">null</span></a><span> </span><a href="#local-6989586621679033210"><span class="hs-identifier hs-var">x</span></a><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-374"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="Data.MultiSet.html#deleteFindMin"><span class="hs-identifier hs-var">deleteFindMin</span></a><span> </span><a href="#local-6989586621679033210"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span>
</span><a name="line-375"></a><span>
</span><a name="line-376"></a><span class="hs-comment">-- | /O(log n)/. Retrieves the maximal element of the multiset,</span><span>
</span><a name="line-377"></a><span class="hs-comment">--   and the set with that element removed.</span><span>
</span><a name="line-378"></a><span class="hs-comment">--   Returns @Nothing@ when passed an empty multiset.</span><span>
</span><a name="line-379"></a><span class="hs-comment">--</span><span>
</span><a name="line-380"></a><span class="hs-comment">-- Examples:</span><span>
</span><a name="line-381"></a><span class="hs-comment">--</span><span>
</span><a name="line-382"></a><span class="hs-comment">-- &gt;&gt;&gt; maxView $ fromList ['a', 'a', 'b', 'c']</span><span>
</span><a name="line-383"></a><span class="hs-comment">-- Just ('c',fromOccurList [('a',2),('b',1)])</span><span>
</span><a name="line-384"></a><span class="hs-identifier">maxView</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.MultiSet.html#MultiSet"><span class="hs-identifier hs-type">MultiSet</span></a><span> </span><a href="#local-6989586621679032964"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679032964"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><a href="Data.MultiSet.html#MultiSet"><span class="hs-identifier hs-type">MultiSet</span></a><span> </span><a href="#local-6989586621679032964"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-385"></a><a name="maxView"><a href="Data.MultiSet.html#maxView"><span class="hs-identifier">maxView</span></a></a><span> </span><a name="local-6989586621679033211"><a href="#local-6989586621679033211"><span class="hs-identifier">x</span></a></a><span>
</span><a name="line-386"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="Data.MultiSet.html#null"><span class="hs-identifier hs-var">null</span></a><span> </span><a href="#local-6989586621679033211"><span class="hs-identifier hs-var">x</span></a><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-387"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="Data.MultiSet.html#deleteFindMax"><span class="hs-identifier hs-var">deleteFindMax</span></a><span> </span><a href="#local-6989586621679033211"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span>
</span><a name="line-388"></a><span>
</span><a name="line-389"></a><span class="hs-comment">{--------------------------------------------------------------------
  Union, Difference, Intersection
--------------------------------------------------------------------}</span><span>
</span><a name="line-392"></a><span>
</span><a name="line-393"></a><span class="hs-comment">-- | The union of a list of multisets: (@'unions' == 'foldl' 'union' 'empty'@).</span><span>
</span><a name="line-394"></a><span class="hs-identifier">unions</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Ord</span><span> </span><a href="#local-6989586621679032963"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><a href="Data.MultiSet.html#MultiSet"><span class="hs-identifier hs-type">MultiSet</span></a><span> </span><a href="#local-6989586621679032963"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.MultiSet.html#MultiSet"><span class="hs-identifier hs-type">MultiSet</span></a><span> </span><a href="#local-6989586621679032963"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-395"></a><a name="unions"><a href="Data.MultiSet.html#unions"><span class="hs-identifier">unions</span></a></a><span> </span><a name="local-6989586621679033212"><a href="#local-6989586621679033212"><span class="hs-identifier">ts</span></a></a><span>
</span><a name="line-396"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Data.MultiSet.html#foldlStrict"><span class="hs-identifier hs-var">foldlStrict</span></a><span> </span><a href="Data.MultiSet.html#union"><span class="hs-identifier hs-var">union</span></a><span> </span><a href="Data.MultiSet.html#empty"><span class="hs-identifier hs-var">empty</span></a><span> </span><a href="#local-6989586621679033212"><span class="hs-identifier hs-var">ts</span></a><span>
</span><a name="line-397"></a><span>
</span><a name="line-398"></a><span class="hs-comment">-- | /O(n+m)/. The union of two multisets. The union adds the occurrences together.</span><span>
</span><a name="line-399"></a><span class="hs-comment">-- </span><span>
</span><a name="line-400"></a><span class="hs-comment">-- The implementation uses the efficient /hedge-union/ algorithm.</span><span>
</span><a name="line-401"></a><span class="hs-comment">-- Hedge-union is more efficient on (bigset `union` smallset).</span><span>
</span><a name="line-402"></a><span class="hs-identifier">union</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Ord</span><span> </span><a href="#local-6989586621679032962"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Data.MultiSet.html#MultiSet"><span class="hs-identifier hs-type">MultiSet</span></a><span> </span><a href="#local-6989586621679032962"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.MultiSet.html#MultiSet"><span class="hs-identifier hs-type">MultiSet</span></a><span> </span><a href="#local-6989586621679032962"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.MultiSet.html#MultiSet"><span class="hs-identifier hs-type">MultiSet</span></a><span> </span><a href="#local-6989586621679032962"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-403"></a><a name="union"><a href="Data.MultiSet.html#union"><span class="hs-identifier">union</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.MultiSet.html#MS"><span class="hs-identifier hs-var">MS</span></a><span> </span><a name="local-6989586621679033213"><a href="#local-6989586621679033213"><span class="hs-identifier">m1</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.MultiSet.html#MS"><span class="hs-identifier hs-var">MS</span></a><span> </span><a name="local-6989586621679033214"><a href="#local-6989586621679033214"><span class="hs-identifier">m2</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.MultiSet.html#MS"><span class="hs-identifier hs-var">MS</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">Map</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">unionWith</span><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">+</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679033213"><span class="hs-identifier hs-var">m1</span></a><span> </span><a href="#local-6989586621679033214"><span class="hs-identifier hs-var">m2</span></a><span>
</span><a name="line-404"></a><span>
</span><a name="line-405"></a><span class="hs-comment">-- | /O(n+m)/. The union of two multisets.</span><span>
</span><a name="line-406"></a><span class="hs-comment">-- The number of occurrences of each element in the union is</span><span>
</span><a name="line-407"></a><span class="hs-comment">-- the maximum of the number of occurrences in the arguments (instead of the sum).</span><span>
</span><a name="line-408"></a><span class="hs-comment">--</span><span>
</span><a name="line-409"></a><span class="hs-comment">-- The implementation uses the efficient /hedge-union/ algorithm.</span><span>
</span><a name="line-410"></a><span class="hs-comment">-- Hedge-union is more efficient on (bigset `union` smallset).</span><span>
</span><a name="line-411"></a><span class="hs-identifier">maxUnion</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Ord</span><span> </span><a href="#local-6989586621679032961"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Data.MultiSet.html#MultiSet"><span class="hs-identifier hs-type">MultiSet</span></a><span> </span><a href="#local-6989586621679032961"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.MultiSet.html#MultiSet"><span class="hs-identifier hs-type">MultiSet</span></a><span> </span><a href="#local-6989586621679032961"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.MultiSet.html#MultiSet"><span class="hs-identifier hs-type">MultiSet</span></a><span> </span><a href="#local-6989586621679032961"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-412"></a><a name="maxUnion"><a href="Data.MultiSet.html#maxUnion"><span class="hs-identifier">maxUnion</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.MultiSet.html#MS"><span class="hs-identifier hs-var">MS</span></a><span> </span><a name="local-6989586621679033215"><a href="#local-6989586621679033215"><span class="hs-identifier">m1</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.MultiSet.html#MS"><span class="hs-identifier hs-var">MS</span></a><span> </span><a name="local-6989586621679033216"><a href="#local-6989586621679033216"><span class="hs-identifier">m2</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.MultiSet.html#MS"><span class="hs-identifier hs-var">MS</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">Map</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">unionWith</span><span> </span><span class="hs-identifier hs-var">max</span><span> </span><a href="#local-6989586621679033215"><span class="hs-identifier hs-var">m1</span></a><span> </span><a href="#local-6989586621679033216"><span class="hs-identifier hs-var">m2</span></a><span>
</span><a name="line-413"></a><span>
</span><a name="line-414"></a><span class="hs-comment">-- | /O(n+m)/. Difference of two multisets. </span><span>
</span><a name="line-415"></a><span class="hs-comment">-- The implementation uses an efficient /hedge/ algorithm comparable with /hedge-union/.</span><span>
</span><a name="line-416"></a><span class="hs-identifier">difference</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Ord</span><span> </span><a href="#local-6989586621679032960"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Data.MultiSet.html#MultiSet"><span class="hs-identifier hs-type">MultiSet</span></a><span> </span><a href="#local-6989586621679032960"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.MultiSet.html#MultiSet"><span class="hs-identifier hs-type">MultiSet</span></a><span> </span><a href="#local-6989586621679032960"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.MultiSet.html#MultiSet"><span class="hs-identifier hs-type">MultiSet</span></a><span> </span><a href="#local-6989586621679032960"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-417"></a><a name="difference"><a href="Data.MultiSet.html#difference"><span class="hs-identifier">difference</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.MultiSet.html#MS"><span class="hs-identifier hs-var">MS</span></a><span> </span><a name="local-6989586621679033217"><a href="#local-6989586621679033217"><span class="hs-identifier">m1</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.MultiSet.html#MS"><span class="hs-identifier hs-var">MS</span></a><span> </span><a name="local-6989586621679033218"><a href="#local-6989586621679033218"><span class="hs-identifier">m2</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.MultiSet.html#MS"><span class="hs-identifier hs-var">MS</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">Map</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">differenceWith</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">flip</span><span> </span><a href="Data.MultiSet.html#deleteN"><span class="hs-identifier hs-var">deleteN</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679033217"><span class="hs-identifier hs-var">m1</span></a><span> </span><a href="#local-6989586621679033218"><span class="hs-identifier hs-var">m2</span></a><span>
</span><a name="line-418"></a><span>
</span><a name="line-419"></a><span class="hs-comment">-- | /O(n+m)/. The intersection of two multisets.</span><span>
</span><a name="line-420"></a><span class="hs-comment">-- Elements of the result come from the first multiset, so for example</span><span>
</span><a name="line-421"></a><span class="hs-comment">--</span><span>
</span><a name="line-422"></a><span class="hs-comment">-- &gt; import qualified Data.MultiSet as MS</span><span>
</span><a name="line-423"></a><span class="hs-comment">-- &gt; data AB = A | B deriving Show</span><span>
</span><a name="line-424"></a><span class="hs-comment">-- &gt; instance Ord AB where compare _ _ = EQ</span><span>
</span><a name="line-425"></a><span class="hs-comment">-- &gt; instance Eq AB where _ == _ = True</span><span>
</span><a name="line-426"></a><span class="hs-comment">-- &gt; main = print (MS.singleton A `MS.intersection` MS.singleton B,</span><span>
</span><a name="line-427"></a><span class="hs-comment">-- &gt;               MS.singleton B `MS.intersection` MS.singleton A)</span><span>
</span><a name="line-428"></a><span class="hs-comment">--</span><span>
</span><a name="line-429"></a><span class="hs-comment">-- prints @(fromList [A],fromList [B])@.</span><span>
</span><a name="line-430"></a><span class="hs-identifier">intersection</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Ord</span><span> </span><a href="#local-6989586621679032959"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Data.MultiSet.html#MultiSet"><span class="hs-identifier hs-type">MultiSet</span></a><span> </span><a href="#local-6989586621679032959"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.MultiSet.html#MultiSet"><span class="hs-identifier hs-type">MultiSet</span></a><span> </span><a href="#local-6989586621679032959"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.MultiSet.html#MultiSet"><span class="hs-identifier hs-type">MultiSet</span></a><span> </span><a href="#local-6989586621679032959"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-431"></a><a name="intersection"><a href="Data.MultiSet.html#intersection"><span class="hs-identifier">intersection</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.MultiSet.html#MS"><span class="hs-identifier hs-var">MS</span></a><span> </span><a name="local-6989586621679033219"><a href="#local-6989586621679033219"><span class="hs-identifier">m1</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.MultiSet.html#MS"><span class="hs-identifier hs-var">MS</span></a><span> </span><a name="local-6989586621679033220"><a href="#local-6989586621679033220"><span class="hs-identifier">m2</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.MultiSet.html#MS"><span class="hs-identifier hs-var">MS</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">Map</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">intersectionWith</span><span> </span><span class="hs-identifier hs-var">min</span><span> </span><a href="#local-6989586621679033219"><span class="hs-identifier hs-var">m1</span></a><span> </span><a href="#local-6989586621679033220"><span class="hs-identifier hs-var">m2</span></a><span>
</span><a name="line-432"></a><span>
</span><a name="line-433"></a><span class="hs-comment">{--------------------------------------------------------------------
  Filter and partition
--------------------------------------------------------------------}</span><span>
</span><a name="line-436"></a><span class="hs-comment">-- | /O(n)/. Filter all elements that satisfy the predicate.</span><span>
</span><a name="line-437"></a><span class="hs-identifier">filter</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679032958"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.MultiSet.html#MultiSet"><span class="hs-identifier hs-type">MultiSet</span></a><span> </span><a href="#local-6989586621679032958"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.MultiSet.html#MultiSet"><span class="hs-identifier hs-type">MultiSet</span></a><span> </span><a href="#local-6989586621679032958"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-438"></a><a name="filter"><a href="Data.MultiSet.html#filter"><span class="hs-identifier">filter</span></a></a><span> </span><a name="local-6989586621679033221"><a href="#local-6989586621679033221"><span class="hs-identifier">p</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.MultiSet.html#MS"><span class="hs-identifier hs-var">MS</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">Map</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">filterWithKey</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679033222"><a href="#local-6989586621679033222"><span class="hs-identifier">k</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679033221"><span class="hs-identifier hs-var">p</span></a><span> </span><a href="#local-6989586621679033222"><span class="hs-identifier hs-var">k</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier">unMS</span><span>
</span><a name="line-439"></a><span>
</span><a name="line-440"></a><span class="hs-comment">-- | /O(n)/. Partition the multiset into two multisets, one with all elements that satisfy</span><span>
</span><a name="line-441"></a><span class="hs-comment">-- the predicate and one with all elements that don't satisfy the predicate.</span><span>
</span><a name="line-442"></a><span class="hs-comment">-- See also 'split'.</span><span>
</span><a name="line-443"></a><span class="hs-identifier">partition</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679032957"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.MultiSet.html#MultiSet"><span class="hs-identifier hs-type">MultiSet</span></a><span> </span><a href="#local-6989586621679032957"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="Data.MultiSet.html#MultiSet"><span class="hs-identifier hs-type">MultiSet</span></a><span> </span><a href="#local-6989586621679032957"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><a href="Data.MultiSet.html#MultiSet"><span class="hs-identifier hs-type">MultiSet</span></a><span> </span><a href="#local-6989586621679032957"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-444"></a><a name="partition"><a href="Data.MultiSet.html#partition"><span class="hs-identifier">partition</span></a></a><span> </span><a name="local-6989586621679033223"><a href="#local-6989586621679033223"><span class="hs-identifier">p</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><a name="local-6989586621679033224"><a href="#local-6989586621679033224"><span class="hs-identifier">x</span></a></a><span class="hs-special">,</span><a name="local-6989586621679033225"><a href="#local-6989586621679033225"><span class="hs-identifier">y</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="Data.MultiSet.html#MS"><span class="hs-identifier hs-var">MS</span></a><span> </span><a href="#local-6989586621679033224"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">,</span><span> </span><a href="Data.MultiSet.html#MS"><span class="hs-identifier hs-var">MS</span></a><span> </span><a href="#local-6989586621679033225"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">Map</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">partitionWithKey</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679033226"><a href="#local-6989586621679033226"><span class="hs-identifier">k</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679033223"><span class="hs-identifier hs-var">p</span></a><span> </span><a href="#local-6989586621679033226"><span class="hs-identifier hs-var">k</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier">unMS</span><span>
</span><a name="line-445"></a><span>
</span><a name="line-446"></a><span class="hs-comment">{----------------------------------------------------------------------
  Map
----------------------------------------------------------------------}</span><span>
</span><a name="line-449"></a><span>
</span><a name="line-450"></a><span class="hs-comment">-- | /O(n*log n)/. </span><span>
</span><a name="line-451"></a><span class="hs-comment">-- @'map' f s@ is the multiset obtained by applying @f@ to each element of @s@.</span><span>
</span><a name="line-452"></a><span class="hs-identifier">map</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Ord</span><span> </span><a href="#local-6989586621679032955"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679032956"><span class="hs-identifier hs-type">a</span></a><span class="hs-glyph">-&gt;</span><a href="#local-6989586621679032955"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.MultiSet.html#MultiSet"><span class="hs-identifier hs-type">MultiSet</span></a><span> </span><a href="#local-6989586621679032956"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.MultiSet.html#MultiSet"><span class="hs-identifier hs-type">MultiSet</span></a><span> </span><a href="#local-6989586621679032955"><span class="hs-identifier hs-type">b</span></a><span>
</span><a name="line-453"></a><a name="map"><a href="Data.MultiSet.html#map"><span class="hs-identifier">map</span></a></a><span> </span><a name="local-6989586621679033227"><a href="#local-6989586621679033227"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.MultiSet.html#MS"><span class="hs-identifier hs-var">MS</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">Map</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">mapKeysWith</span><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">+</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679033227"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier">unMS</span><span>
</span><a name="line-454"></a><span>
</span><a name="line-455"></a><span class="hs-comment">-- | /O(n)/. The </span><span>
</span><a name="line-456"></a><span class="hs-comment">--</span><span>
</span><a name="line-457"></a><span class="hs-comment">-- @'mapMonotonic' f s == 'map' f s@, but works only when @f@ is strictly monotonic.</span><span>
</span><a name="line-458"></a><span class="hs-comment">-- /The precondition is not checked./</span><span>
</span><a name="line-459"></a><span class="hs-comment">-- Semi-formally, we have:</span><span>
</span><a name="line-460"></a><span class="hs-comment">-- </span><span>
</span><a name="line-461"></a><span class="hs-comment">-- &gt; and [x &lt; y ==&gt; f x &lt; f y | x &lt;- ls, y &lt;- ls]</span><span>
</span><a name="line-462"></a><span class="hs-comment">-- &gt;                     ==&gt; mapMonotonic f s == map f s</span><span>
</span><a name="line-463"></a><span class="hs-comment">-- &gt;     where ls = toList s</span><span>
</span><a name="line-464"></a><span class="hs-identifier">mapMonotonic</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679032953"><span class="hs-identifier hs-type">a</span></a><span class="hs-glyph">-&gt;</span><a href="#local-6989586621679032954"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.MultiSet.html#MultiSet"><span class="hs-identifier hs-type">MultiSet</span></a><span> </span><a href="#local-6989586621679032953"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.MultiSet.html#MultiSet"><span class="hs-identifier hs-type">MultiSet</span></a><span> </span><a href="#local-6989586621679032954"><span class="hs-identifier hs-type">b</span></a><span>
</span><a name="line-465"></a><a name="mapMonotonic"><a href="Data.MultiSet.html#mapMonotonic"><span class="hs-identifier">mapMonotonic</span></a></a><span> </span><a name="local-6989586621679033228"><a href="#local-6989586621679033228"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.MultiSet.html#MS"><span class="hs-identifier hs-var">MS</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">Map</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">mapKeysMonotonic</span><span> </span><a href="#local-6989586621679033228"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier">unMS</span><span>
</span><a name="line-466"></a><span>
</span><a name="line-467"></a><span class="hs-comment">-- | /O(n)/. Map and collect the 'Just' results.</span><span>
</span><a name="line-468"></a><span class="hs-identifier">mapMaybe</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Ord</span><span> </span><a href="#local-6989586621679032951"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679032952"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="#local-6989586621679032951"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.MultiSet.html#MultiSet"><span class="hs-identifier hs-type">MultiSet</span></a><span> </span><a href="#local-6989586621679032952"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.MultiSet.html#MultiSet"><span class="hs-identifier hs-type">MultiSet</span></a><span> </span><a href="#local-6989586621679032951"><span class="hs-identifier hs-type">b</span></a><span>
</span><a name="line-469"></a><a name="mapMaybe"><a href="Data.MultiSet.html#mapMaybe"><span class="hs-identifier">mapMaybe</span></a></a><span> </span><a name="local-6989586621679033229"><a href="#local-6989586621679033229"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.MultiSet.html#fromOccurList"><span class="hs-identifier hs-var">fromOccurList</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="#local-6989586621679033230"><span class="hs-identifier hs-var">mapMaybe'</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Data.MultiSet.html#toOccurList"><span class="hs-identifier hs-var">toOccurList</span></a><span>
</span><a name="line-470"></a><span>  </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621679033230"><a href="#local-6989586621679033230"><span class="hs-identifier">mapMaybe'</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-471"></a><span>        </span><span class="hs-identifier">mapMaybe'</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><a name="local-6989586621679033231"><a href="#local-6989586621679033231"><span class="hs-identifier">x</span></a></a><span class="hs-special">,</span><a name="local-6989586621679033232"><a href="#local-6989586621679033232"><span class="hs-identifier">n</span></a></a><span class="hs-special">)</span><span class="hs-glyph">:</span><a name="local-6989586621679033233"><a href="#local-6989586621679033233"><span class="hs-identifier">xs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679033229"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679033231"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-472"></a><span>           </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679033234"><a href="#local-6989586621679033234"><span class="hs-identifier">x'</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679033234"><span class="hs-identifier hs-var">x'</span></a><span class="hs-special">,</span><a href="#local-6989586621679033232"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">:</span><span> </span><a href="#local-6989586621679033230"><span class="hs-identifier hs-var">mapMaybe'</span></a><span> </span><a href="#local-6989586621679033233"><span class="hs-identifier hs-var">xs</span></a><span>
</span><a name="line-473"></a><span>           </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-glyph">-&gt;</span><span>          </span><a href="#local-6989586621679033230"><span class="hs-identifier hs-var">mapMaybe'</span></a><span> </span><a href="#local-6989586621679033233"><span class="hs-identifier hs-var">xs</span></a><span>
</span><a name="line-474"></a><span>
</span><a name="line-475"></a><span class="hs-comment">-- | /O(n)/. Map and separate the 'Left' and 'Right' results.</span><span>
</span><a name="line-476"></a><span class="hs-identifier">mapEither</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Ord</span><span> </span><a href="#local-6989586621679032816"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Ord</span><span> </span><a href="#local-6989586621679032817"><span class="hs-identifier hs-type">c</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679032818"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Either</span><span> </span><a href="#local-6989586621679032816"><span class="hs-identifier hs-type">b</span></a><span> </span><a href="#local-6989586621679032817"><span class="hs-identifier hs-type">c</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.MultiSet.html#MultiSet"><span class="hs-identifier hs-type">MultiSet</span></a><span> </span><a href="#local-6989586621679032818"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="Data.MultiSet.html#MultiSet"><span class="hs-identifier hs-type">MultiSet</span></a><span> </span><a href="#local-6989586621679032816"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">,</span><span> </span><a href="Data.MultiSet.html#MultiSet"><span class="hs-identifier hs-type">MultiSet</span></a><span> </span><a href="#local-6989586621679032817"><span class="hs-identifier hs-type">c</span></a><span class="hs-special">)</span><span>
</span><a name="line-477"></a><a name="mapEither"><a href="Data.MultiSet.html#mapEither"><span class="hs-identifier">mapEither</span></a></a><span> </span><a name="local-6989586621679033235"><a href="#local-6989586621679033235"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><a name="local-6989586621679033246"><a href="#local-6989586621679033246"><span class="hs-identifier">ls</span></a></a><span class="hs-special">,</span><a name="local-6989586621679033247"><a href="#local-6989586621679033247"><span class="hs-identifier">rs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="Data.MultiSet.html#fromOccurList"><span class="hs-identifier hs-var">fromOccurList</span></a><span> </span><a href="#local-6989586621679033246"><span class="hs-identifier hs-var">ls</span></a><span class="hs-special">,</span><span> </span><a href="Data.MultiSet.html#fromOccurList"><span class="hs-identifier hs-var">fromOccurList</span></a><span> </span><a href="#local-6989586621679033247"><span class="hs-identifier hs-var">rs</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="#local-6989586621679033236"><span class="hs-identifier hs-var">mapEither'</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Data.MultiSet.html#toOccurList"><span class="hs-identifier hs-var">toOccurList</span></a><span>
</span><a name="line-478"></a><span>  </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621679033236"><a href="#local-6989586621679033236"><span class="hs-identifier">mapEither'</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-479"></a><span>        </span><span class="hs-identifier">mapEither'</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><a name="local-6989586621679033237"><a href="#local-6989586621679033237"><span class="hs-identifier">x</span></a></a><span class="hs-special">,</span><a name="local-6989586621679033238"><a href="#local-6989586621679033238"><span class="hs-identifier">n</span></a></a><span class="hs-special">)</span><span class="hs-glyph">:</span><a name="local-6989586621679033239"><a href="#local-6989586621679033239"><span class="hs-identifier">xs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679033235"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679033237"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-480"></a><span>           </span><span class="hs-identifier hs-var">Left</span><span>  </span><a name="local-6989586621679033240"><a href="#local-6989586621679033240"><span class="hs-identifier">l</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679033241"><a href="#local-6989586621679033241"><span class="hs-identifier">ls</span></a></a><span class="hs-special">,</span><a name="local-6989586621679033242"><a href="#local-6989586621679033242"><span class="hs-identifier">rs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679033236"><span class="hs-identifier hs-var">mapEither'</span></a><span> </span><a href="#local-6989586621679033239"><span class="hs-identifier hs-var">xs</span></a><span> </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><a href="#local-6989586621679033240"><span class="hs-identifier hs-var">l</span></a><span class="hs-special">,</span><a href="#local-6989586621679033238"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">)</span><span class="hs-glyph">:</span><a href="#local-6989586621679033241"><span class="hs-identifier hs-var">ls</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679033242"><span class="hs-identifier hs-var">rs</span></a><span class="hs-special">)</span><span>
</span><a name="line-481"></a><span>           </span><span class="hs-identifier hs-var">Right</span><span> </span><a name="local-6989586621679033243"><a href="#local-6989586621679033243"><span class="hs-identifier">r</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679033244"><a href="#local-6989586621679033244"><span class="hs-identifier">ls</span></a></a><span class="hs-special">,</span><a name="local-6989586621679033245"><a href="#local-6989586621679033245"><span class="hs-identifier">rs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679033236"><span class="hs-identifier hs-var">mapEither'</span></a><span> </span><a href="#local-6989586621679033239"><span class="hs-identifier hs-var">xs</span></a><span> </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679033244"><span class="hs-identifier hs-var">ls</span></a><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679033243"><span class="hs-identifier hs-var">r</span></a><span class="hs-special">,</span><a href="#local-6989586621679033238"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">)</span><span class="hs-glyph">:</span><a href="#local-6989586621679033245"><span class="hs-identifier hs-var">rs</span></a><span class="hs-special">)</span><span>
</span><a name="line-482"></a><span>
</span><a name="line-483"></a><span>
</span><a name="line-484"></a><span class="hs-comment">-- | /O(n)/. Apply a function to each element, and take the union of the results</span><span>
</span><a name="line-485"></a><span class="hs-identifier">concatMap</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Ord</span><span> </span><a href="#local-6989586621679032814"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679032815"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679032814"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.MultiSet.html#MultiSet"><span class="hs-identifier hs-type">MultiSet</span></a><span> </span><a href="#local-6989586621679032815"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.MultiSet.html#MultiSet"><span class="hs-identifier hs-type">MultiSet</span></a><span> </span><a href="#local-6989586621679032814"><span class="hs-identifier hs-type">b</span></a><span>
</span><a name="line-486"></a><a name="concatMap"><a href="Data.MultiSet.html#concatMap"><span class="hs-identifier">concatMap</span></a></a><span> </span><a name="local-6989586621679033248"><a href="#local-6989586621679033248"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.MultiSet.html#fromOccurList"><span class="hs-identifier hs-var">fromOccurList</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">Map</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">foldrWithKey</span><span> </span><a href="#local-6989586621679033249"><span class="hs-identifier hs-var">mapF</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier">unMS</span><span>
</span><a name="line-487"></a><span>  </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621679033249"><a href="#local-6989586621679033249"><span class="hs-identifier">mapF</span></a></a><span> </span><a name="local-6989586621679033250"><a href="#local-6989586621679033250"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679033251"><a href="#local-6989586621679033251"><span class="hs-identifier">occ</span></a></a><span> </span><a name="local-6989586621679033252"><a href="#local-6989586621679033252"><span class="hs-identifier">rest</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">List</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679033253"><a href="#local-6989586621679033253"><span class="hs-identifier">y</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679033253"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">,</span><a href="#local-6989586621679033251"><span class="hs-identifier hs-var">occ</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679033248"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679033250"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><a href="#local-6989586621679033252"><span class="hs-identifier hs-var">rest</span></a><span>
</span><a name="line-488"></a><span>
</span><a name="line-489"></a><span class="hs-comment">-- | /O(n)/. Apply a function to each element, and take the union of the results</span><span>
</span><a name="line-490"></a><span class="hs-identifier">unionsMap</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Ord</span><span> </span><a href="#local-6989586621679032812"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679032813"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.MultiSet.html#MultiSet"><span class="hs-identifier hs-type">MultiSet</span></a><span> </span><a href="#local-6989586621679032812"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.MultiSet.html#MultiSet"><span class="hs-identifier hs-type">MultiSet</span></a><span> </span><a href="#local-6989586621679032813"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.MultiSet.html#MultiSet"><span class="hs-identifier hs-type">MultiSet</span></a><span> </span><a href="#local-6989586621679032812"><span class="hs-identifier hs-type">b</span></a><span>
</span><a name="line-491"></a><a name="unionsMap"><a href="Data.MultiSet.html#unionsMap"><span class="hs-identifier">unionsMap</span></a></a><span> </span><a name="local-6989586621679033254"><a href="#local-6989586621679033254"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.MultiSet.html#unions"><span class="hs-identifier hs-var">unions</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">List</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">map</span><span> </span><a href="#local-6989586621679033255"><span class="hs-identifier hs-var">timesF</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Data.MultiSet.html#toOccurList"><span class="hs-identifier hs-var">toOccurList</span></a><span>
</span><a name="line-492"></a><span>  </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621679033255"><a href="#local-6989586621679033255"><span class="hs-identifier">timesF</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679033256"><a href="#local-6989586621679033256"><span class="hs-identifier">ms</span></a></a><span class="hs-special">,</span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679033254"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679033256"><span class="hs-identifier hs-var">ms</span></a><span>
</span><a name="line-493"></a><span>        </span><span class="hs-identifier">timesF</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679033257"><a href="#local-6989586621679033257"><span class="hs-identifier">ms</span></a></a><span class="hs-special">,</span><a name="local-6989586621679033258"><a href="#local-6989586621679033258"><span class="hs-identifier">n</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.MultiSet.html#MS"><span class="hs-identifier hs-var">MS</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">Map</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">*</span><a href="#local-6989586621679033258"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier">unMS</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-6989586621679033254"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679033257"><span class="hs-identifier hs-var">ms</span></a><span>
</span><a name="line-494"></a><span>
</span><a name="line-495"></a><span class="hs-comment">-- | /O(n)/. The monad join operation for multisets.</span><span>
</span><a name="line-496"></a><span class="hs-identifier">join</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Ord</span><span> </span><a href="#local-6989586621679032811"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Data.MultiSet.html#MultiSet"><span class="hs-identifier hs-type">MultiSet</span></a><span> </span><span class="hs-special">(</span><a href="Data.MultiSet.html#MultiSet"><span class="hs-identifier hs-type">MultiSet</span></a><span> </span><a href="#local-6989586621679032811"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.MultiSet.html#MultiSet"><span class="hs-identifier hs-type">MultiSet</span></a><span> </span><a href="#local-6989586621679032811"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-497"></a><a name="join"><a href="Data.MultiSet.html#join"><span class="hs-identifier">join</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.MultiSet.html#unions"><span class="hs-identifier hs-var">unions</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">List</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">map</span><span> </span><a href="#local-6989586621679033259"><span class="hs-identifier hs-var">times</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Data.MultiSet.html#toOccurList"><span class="hs-identifier hs-var">toOccurList</span></a><span>
</span><a name="line-498"></a><span>  </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621679033259"><a href="#local-6989586621679033259"><span class="hs-identifier">times</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679033260"><a href="#local-6989586621679033260"><span class="hs-identifier">ms</span></a></a><span class="hs-special">,</span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679033260"><span class="hs-identifier hs-var">ms</span></a><span>
</span><a name="line-499"></a><span>        </span><span class="hs-identifier">times</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679033261"><a href="#local-6989586621679033261"><span class="hs-identifier">ms</span></a></a><span class="hs-special">,</span><a name="local-6989586621679033262"><a href="#local-6989586621679033262"><span class="hs-identifier">n</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.MultiSet.html#MS"><span class="hs-identifier hs-var">MS</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">Map</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">*</span><a href="#local-6989586621679033262"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier">unMS</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-6989586621679033261"><span class="hs-identifier hs-var">ms</span></a><span>
</span><a name="line-500"></a><span>
</span><a name="line-501"></a><span class="hs-comment">-- | /O(n)/. The monad bind operation, (&gt;&gt;=), for multisets.</span><span>
</span><a name="line-502"></a><span class="hs-identifier">bind</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Ord</span><span> </span><a href="#local-6989586621679032809"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Data.MultiSet.html#MultiSet"><span class="hs-identifier hs-type">MultiSet</span></a><span> </span><a href="#local-6989586621679032810"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679032810"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.MultiSet.html#MultiSet"><span class="hs-identifier hs-type">MultiSet</span></a><span> </span><a href="#local-6989586621679032809"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.MultiSet.html#MultiSet"><span class="hs-identifier hs-type">MultiSet</span></a><span> </span><a href="#local-6989586621679032809"><span class="hs-identifier hs-type">b</span></a><span>
</span><a name="line-503"></a><a name="bind"><a href="Data.MultiSet.html#bind"><span class="hs-identifier">bind</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">flip</span><span> </span><a href="Data.MultiSet.html#unionsMap"><span class="hs-identifier hs-var">unionsMap</span></a><span>
</span><a name="line-504"></a><span>
</span><a name="line-505"></a><span class="hs-comment">{--------------------------------------------------------------------
  Fold
--------------------------------------------------------------------}</span><span>
</span><a name="line-508"></a><span>
</span><a name="line-509"></a><span class="hs-comment">-- | /O(t)/. Fold over the elements of a multiset in an unspecified order.</span><span>
</span><a name="line-510"></a><span class="hs-identifier">fold</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679032807"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679032808"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679032808"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679032808"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.MultiSet.html#MultiSet"><span class="hs-identifier hs-type">MultiSet</span></a><span> </span><a href="#local-6989586621679032807"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679032808"><span class="hs-identifier hs-type">b</span></a><span>
</span><a name="line-511"></a><a name="fold"><a href="Data.MultiSet.html#fold"><span class="hs-identifier">fold</span></a></a><span> </span><a name="local-6989586621679033263"><a href="#local-6989586621679033263"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679033264"><a href="#local-6989586621679033264"><span class="hs-identifier">z</span></a></a><span> </span><a name="local-6989586621679033265"><a href="#local-6989586621679033265"><span class="hs-identifier">s</span></a></a><span>
</span><a name="line-512"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Data.MultiSet.html#foldr"><span class="hs-identifier hs-var">foldr</span></a><span> </span><a href="#local-6989586621679033263"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679033264"><span class="hs-identifier hs-var">z</span></a><span> </span><a href="#local-6989586621679033265"><span class="hs-identifier hs-var">s</span></a><span>
</span><a name="line-513"></a><span>
</span><a name="line-514"></a><span class="hs-comment">-- | /O(t)/. Post-order fold.</span><span>
</span><a name="line-515"></a><span class="hs-identifier">foldr</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679032805"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679032806"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679032806"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679032806"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.MultiSet.html#MultiSet"><span class="hs-identifier hs-type">MultiSet</span></a><span> </span><a href="#local-6989586621679032805"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679032806"><span class="hs-identifier hs-type">b</span></a><span>
</span><a name="line-516"></a><a name="foldr"><a href="Data.MultiSet.html#foldr"><span class="hs-identifier">foldr</span></a></a><span> </span><a name="local-6989586621679033266"><a href="#local-6989586621679033266"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679033267"><a href="#local-6989586621679033267"><span class="hs-identifier">z</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Map</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">foldrWithKey</span><span> </span><a href="#local-6989586621679033268"><span class="hs-identifier hs-var">repF</span></a><span> </span><a href="#local-6989586621679033267"><span class="hs-identifier hs-var">z</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier">unMS</span><span>
</span><a name="line-517"></a><span> </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621679033268"><a href="#local-6989586621679033268"><span class="hs-identifier">repF</span></a></a><span> </span><a name="local-6989586621679033269"><a href="#local-6989586621679033269"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-number">1</span><span> </span><a name="local-6989586621679033270"><a href="#local-6989586621679033270"><span class="hs-identifier">b</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679033266"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679033269"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="#local-6989586621679033270"><span class="hs-identifier hs-var">b</span></a><span>
</span><a name="line-518"></a><span>       </span><span class="hs-identifier">repF</span><span> </span><a name="local-6989586621679033271"><a href="#local-6989586621679033271"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679033272"><a href="#local-6989586621679033272"><span class="hs-identifier">n</span></a></a><span> </span><a name="local-6989586621679033273"><a href="#local-6989586621679033273"><span class="hs-identifier">b</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679033268"><span class="hs-identifier hs-var">repF</span></a><span> </span><a href="#local-6989586621679033271"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679033272"><span class="hs-identifier hs-var">n</span></a><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679033266"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679033271"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="#local-6989586621679033273"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">)</span><span>
</span><a name="line-519"></a><span>
</span><a name="line-520"></a><span class="hs-comment">-- | /O(n)/. Fold over the elements of a multiset with their occurrences.</span><span>
</span><a name="line-521"></a><span class="hs-identifier">foldOccur</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679032803"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.MultiSet.html#Occur"><span class="hs-identifier hs-type">Occur</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679032804"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679032804"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679032804"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.MultiSet.html#MultiSet"><span class="hs-identifier hs-type">MultiSet</span></a><span> </span><a href="#local-6989586621679032803"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679032804"><span class="hs-identifier hs-type">b</span></a><span>
</span><a name="line-522"></a><a name="foldOccur"><a href="Data.MultiSet.html#foldOccur"><span class="hs-identifier">foldOccur</span></a></a><span> </span><a name="local-6989586621679033274"><a href="#local-6989586621679033274"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679033275"><a href="#local-6989586621679033275"><span class="hs-identifier">z</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Map</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">foldrWithKey</span><span> </span><a href="#local-6989586621679033274"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679033275"><span class="hs-identifier hs-var">z</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier">unMS</span><span>
</span><a name="line-523"></a><span>
</span><a name="line-524"></a><span class="hs-comment">{--------------------------------------------------------------------
  List variations 
--------------------------------------------------------------------}</span><span>
</span><a name="line-527"></a><span class="hs-comment">-- | /O(t)/. The elements of a multiset.</span><span>
</span><a name="line-528"></a><span class="hs-identifier">elems</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.MultiSet.html#MultiSet"><span class="hs-identifier hs-type">MultiSet</span></a><span> </span><a href="#local-6989586621679032802"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679032802"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span>
</span><a name="line-529"></a><a name="elems"><a href="Data.MultiSet.html#elems"><span class="hs-identifier">elems</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.MultiSet.html#toList"><span class="hs-identifier hs-var">toList</span></a><span>
</span><a name="line-530"></a><span>
</span><a name="line-531"></a><span class="hs-comment">-- | /O(n)/. The distinct elements of a multiset, each element occurs only once in the list.</span><span>
</span><a name="line-532"></a><span class="hs-comment">--</span><span>
</span><a name="line-533"></a><span class="hs-comment">-- &gt; distinctElems = map fst . toOccurList</span><span>
</span><a name="line-534"></a><span class="hs-identifier">distinctElems</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.MultiSet.html#MultiSet"><span class="hs-identifier hs-type">MultiSet</span></a><span> </span><a href="#local-6989586621679032801"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679032801"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span>
</span><a name="line-535"></a><a name="distinctElems"><a href="Data.MultiSet.html#distinctElems"><span class="hs-identifier">distinctElems</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Map</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">keys</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier">unMS</span><span>
</span><a name="line-536"></a><span>
</span><a name="line-537"></a><span class="hs-comment">{--------------------------------------------------------------------
  Lists 
--------------------------------------------------------------------}</span><span>
</span><a name="line-540"></a><span class="hs-comment">-- | /O(t)/. Convert the multiset to a list of elements.</span><span>
</span><a name="line-541"></a><span class="hs-identifier">toList</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.MultiSet.html#MultiSet"><span class="hs-identifier hs-type">MultiSet</span></a><span> </span><a href="#local-6989586621679032800"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679032800"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span>
</span><a name="line-542"></a><a name="toList"><a href="Data.MultiSet.html#toList"><span class="hs-identifier">toList</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.MultiSet.html#toAscList"><span class="hs-identifier hs-var">toAscList</span></a><span>
</span><a name="line-543"></a><span>
</span><a name="line-544"></a><span class="hs-comment">-- | /O(t)/. Convert the multiset to an ascending list of elements.</span><span>
</span><a name="line-545"></a><span class="hs-identifier">toAscList</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.MultiSet.html#MultiSet"><span class="hs-identifier hs-type">MultiSet</span></a><span> </span><a href="#local-6989586621679032799"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679032799"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span>
</span><a name="line-546"></a><a name="toAscList"><a href="Data.MultiSet.html#toAscList"><span class="hs-identifier">toAscList</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.MultiSet.html#foldr"><span class="hs-identifier hs-var">foldr</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">:</span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-547"></a><span>
</span><a name="line-548"></a><span class="hs-comment">-- | /O(t*log t)/. Create a multiset from a list of elements.</span><span>
</span><a name="line-549"></a><span class="hs-identifier">fromList</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Ord</span><span> </span><a href="#local-6989586621679032798"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679032798"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.MultiSet.html#MultiSet"><span class="hs-identifier hs-type">MultiSet</span></a><span> </span><a href="#local-6989586621679032798"><span class="hs-identifier hs-type">a</span></a><span> </span><span>
</span><a name="line-550"></a><a name="fromList"><a href="Data.MultiSet.html#fromList"><span class="hs-identifier">fromList</span></a></a><span> </span><a name="local-6989586621679033276"><a href="#local-6989586621679033276"><span class="hs-identifier">xs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.MultiSet.html#fromOccurList"><span class="hs-identifier hs-var">fromOccurList</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">zip</span><span> </span><a href="#local-6989586621679033276"><span class="hs-identifier hs-var">xs</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">repeat</span><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span>
</span><a name="line-551"></a><span>
</span><a name="line-552"></a><span class="hs-comment">-- | /O(t)/. Build a multiset from an ascending list in linear time.</span><span>
</span><a name="line-553"></a><span class="hs-comment">-- /The precondition (input list is ascending) is not checked./</span><span>
</span><a name="line-554"></a><span class="hs-identifier">fromAscList</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Eq</span><span> </span><a href="#local-6989586621679032797"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679032797"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.MultiSet.html#MultiSet"><span class="hs-identifier hs-type">MultiSet</span></a><span> </span><a href="#local-6989586621679032797"><span class="hs-identifier hs-type">a</span></a><span> </span><span>
</span><a name="line-555"></a><a name="fromAscList"><a href="Data.MultiSet.html#fromAscList"><span class="hs-identifier">fromAscList</span></a></a><span> </span><a name="local-6989586621679033454"><a href="#local-6989586621679033454"><span class="hs-identifier">xs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.MultiSet.html#fromAscOccurList"><span class="hs-identifier hs-var">fromAscOccurList</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">zip</span><span> </span><a href="#local-6989586621679033454"><span class="hs-identifier hs-var">xs</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">repeat</span><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span>
</span><a name="line-556"></a><span>
</span><a name="line-557"></a><span class="hs-comment">-- | /O(n)/. Build a multiset from an ascending list of distinct elements in linear time.</span><span>
</span><a name="line-558"></a><span class="hs-comment">-- /The precondition (input list is strictly ascending) is not checked./</span><span>
</span><a name="line-559"></a><span class="hs-identifier">fromDistinctAscList</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679032796"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.MultiSet.html#MultiSet"><span class="hs-identifier hs-type">MultiSet</span></a><span> </span><a href="#local-6989586621679032796"><span class="hs-identifier hs-type">a</span></a><span> </span><span>
</span><a name="line-560"></a><a name="fromDistinctAscList"><a href="Data.MultiSet.html#fromDistinctAscList"><span class="hs-identifier">fromDistinctAscList</span></a></a><span> </span><a name="local-6989586621679033455"><a href="#local-6989586621679033455"><span class="hs-identifier">xs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.MultiSet.html#fromDistinctAscOccurList"><span class="hs-identifier hs-var">fromDistinctAscOccurList</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">zip</span><span> </span><a href="#local-6989586621679033455"><span class="hs-identifier hs-var">xs</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">repeat</span><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span>
</span><a name="line-561"></a><span>
</span><a name="line-562"></a><span class="hs-comment">{--------------------------------------------------------------------
  Occurrence lists 
--------------------------------------------------------------------}</span><span>
</span><a name="line-565"></a><span>
</span><a name="line-566"></a><span class="hs-comment">-- | /O(n)/. Convert the multiset to a list of element\/occurrence pairs.</span><span>
</span><a name="line-567"></a><span class="hs-identifier">toOccurList</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.MultiSet.html#MultiSet"><span class="hs-identifier hs-type">MultiSet</span></a><span> </span><a href="#local-6989586621679032795"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><a href="#local-6989586621679032795"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><a href="Data.MultiSet.html#Occur"><span class="hs-identifier hs-type">Occur</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-568"></a><a name="toOccurList"><a href="Data.MultiSet.html#toOccurList"><span class="hs-identifier">toOccurList</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.MultiSet.html#toAscOccurList"><span class="hs-identifier hs-var">toAscOccurList</span></a><span>
</span><a name="line-569"></a><span>
</span><a name="line-570"></a><span class="hs-comment">-- | /O(n)/. Convert the multiset to an ascending list of element\/occurrence pairs.</span><span>
</span><a name="line-571"></a><span class="hs-identifier">toAscOccurList</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.MultiSet.html#MultiSet"><span class="hs-identifier hs-type">MultiSet</span></a><span> </span><a href="#local-6989586621679032794"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><a href="#local-6989586621679032794"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><a href="Data.MultiSet.html#Occur"><span class="hs-identifier hs-type">Occur</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-572"></a><a name="toAscOccurList"><a href="Data.MultiSet.html#toAscOccurList"><span class="hs-identifier">toAscOccurList</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Map</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">toAscList</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier">unMS</span><span>
</span><a name="line-573"></a><span>
</span><a name="line-574"></a><span>
</span><a name="line-575"></a><span class="hs-comment">-- | /O(n*log n)/. Create a multiset from a list of element\/occurrence pairs.</span><span>
</span><a name="line-576"></a><span class="hs-comment">-- Occurrences must be positive.</span><span>
</span><a name="line-577"></a><span class="hs-comment">-- /The precondition (all occurrences &gt; 0) is not checked./</span><span>
</span><a name="line-578"></a><span class="hs-identifier">fromOccurList</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Ord</span><span> </span><a href="#local-6989586621679032793"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><a href="#local-6989586621679032793"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><a href="Data.MultiSet.html#Occur"><span class="hs-identifier hs-type">Occur</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.MultiSet.html#MultiSet"><span class="hs-identifier hs-type">MultiSet</span></a><span> </span><a href="#local-6989586621679032793"><span class="hs-identifier hs-type">a</span></a><span> </span><span>
</span><a name="line-579"></a><a name="fromOccurList"><a href="Data.MultiSet.html#fromOccurList"><span class="hs-identifier">fromOccurList</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.MultiSet.html#MS"><span class="hs-identifier hs-var">MS</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">Map</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">fromListWith</span><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">+</span><span class="hs-special">)</span><span>
</span><a name="line-580"></a><span>
</span><a name="line-581"></a><span class="hs-comment">-- | /O(n)/. Build a multiset from an ascending list of element\/occurrence pairs in linear time.</span><span>
</span><a name="line-582"></a><span class="hs-comment">-- Occurrences must be positive.</span><span>
</span><a name="line-583"></a><span class="hs-comment">-- /The precondition (input list is ascending, all occurrences &gt; 0) is not checked./</span><span>
</span><a name="line-584"></a><span class="hs-identifier">fromAscOccurList</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Eq</span><span> </span><a href="#local-6989586621679032792"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><a href="#local-6989586621679032792"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><a href="Data.MultiSet.html#Occur"><span class="hs-identifier hs-type">Occur</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.MultiSet.html#MultiSet"><span class="hs-identifier hs-type">MultiSet</span></a><span> </span><a href="#local-6989586621679032792"><span class="hs-identifier hs-type">a</span></a><span> </span><span>
</span><a name="line-585"></a><a name="fromAscOccurList"><a href="Data.MultiSet.html#fromAscOccurList"><span class="hs-identifier">fromAscOccurList</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.MultiSet.html#MS"><span class="hs-identifier hs-var">MS</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">Map</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">fromAscListWith</span><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">+</span><span class="hs-special">)</span><span>
</span><a name="line-586"></a><span>
</span><a name="line-587"></a><span class="hs-comment">-- | /O(n)/. Build a multiset from an ascending list of elements\/occurrence pairs where each elements appears only once.</span><span>
</span><a name="line-588"></a><span class="hs-comment">-- Occurrences must be positive.</span><span>
</span><a name="line-589"></a><span class="hs-comment">-- /The precondition (input list is strictly ascending, all occurrences &gt; 0) is not checked./</span><span>
</span><a name="line-590"></a><span class="hs-identifier">fromDistinctAscOccurList</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><a href="#local-6989586621679032791"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><a href="Data.MultiSet.html#Occur"><span class="hs-identifier hs-type">Occur</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.MultiSet.html#MultiSet"><span class="hs-identifier hs-type">MultiSet</span></a><span> </span><a href="#local-6989586621679032791"><span class="hs-identifier hs-type">a</span></a><span> </span><span>
</span><a name="line-591"></a><a name="fromDistinctAscOccurList"><a href="Data.MultiSet.html#fromDistinctAscOccurList"><span class="hs-identifier">fromDistinctAscOccurList</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.MultiSet.html#MS"><span class="hs-identifier hs-var">MS</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">Map</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">fromDistinctAscList</span><span>
</span><a name="line-592"></a><span>
</span><a name="line-593"></a><span class="hs-comment">{--------------------------------------------------------------------
  Map
--------------------------------------------------------------------}</span><span>
</span><a name="line-596"></a><span>
</span><a name="line-597"></a><span class="hs-comment">-- | /O(1)/. Convert a multiset to a 'Map' from elements to number of occurrences.</span><span>
</span><a name="line-598"></a><span class="hs-identifier">toMap</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.MultiSet.html#MultiSet"><span class="hs-identifier hs-type">MultiSet</span></a><span> </span><a href="#local-6989586621679032790"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Map</span><span> </span><a href="#local-6989586621679032790"><span class="hs-identifier hs-type">a</span></a><span> </span><a href="Data.MultiSet.html#Occur"><span class="hs-identifier hs-type">Occur</span></a><span>
</span><a name="line-599"></a><a name="toMap"><a href="Data.MultiSet.html#toMap"><span class="hs-identifier">toMap</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">unMS</span><span>
</span><a name="line-600"></a><span>
</span><a name="line-601"></a><span class="hs-comment">-- | /O(n)/. Convert a 'Map' from elements to occurrences to a multiset.</span><span>
</span><a name="line-602"></a><span class="hs-identifier">fromMap</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Map</span><span> </span><a href="#local-6989586621679032789"><span class="hs-identifier hs-type">a</span></a><span> </span><a href="Data.MultiSet.html#Occur"><span class="hs-identifier hs-type">Occur</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.MultiSet.html#MultiSet"><span class="hs-identifier hs-type">MultiSet</span></a><span> </span><a href="#local-6989586621679032789"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-603"></a><a name="fromMap"><a href="Data.MultiSet.html#fromMap"><span class="hs-identifier">fromMap</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.MultiSet.html#MS"><span class="hs-identifier hs-var">MS</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">Map</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">filter</span><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">&gt;</span><span class="hs-number">0</span><span class="hs-special">)</span><span>
</span><a name="line-604"></a><span>
</span><a name="line-605"></a><span class="hs-comment">-- | /O(1)/. Convert a 'Map' from elements to occurrences to a multiset.</span><span>
</span><a name="line-606"></a><span class="hs-comment">-- Assumes that the 'Map' contains only values larger than zero.</span><span>
</span><a name="line-607"></a><span class="hs-comment">-- /The precondition (all elements &gt; 0) is not checked./</span><span>
</span><a name="line-608"></a><span class="hs-identifier">fromOccurMap</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Map</span><span> </span><a href="#local-6989586621679032788"><span class="hs-identifier hs-type">a</span></a><span> </span><a href="Data.MultiSet.html#Occur"><span class="hs-identifier hs-type">Occur</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.MultiSet.html#MultiSet"><span class="hs-identifier hs-type">MultiSet</span></a><span> </span><a href="#local-6989586621679032788"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-609"></a><a name="fromOccurMap"><a href="Data.MultiSet.html#fromOccurMap"><span class="hs-identifier">fromOccurMap</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.MultiSet.html#MS"><span class="hs-identifier hs-var">MS</span></a><span>
</span><a name="line-610"></a><span>
</span><a name="line-611"></a><span class="hs-comment">{--------------------------------------------------------------------
  Set
--------------------------------------------------------------------}</span><span>
</span><a name="line-614"></a><span>
</span><a name="line-615"></a><span class="hs-comment">-- | /O(n)/. Convert a multiset to a 'Set', removing duplicates.</span><span>
</span><a name="line-616"></a><span class="hs-identifier">toSet</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.MultiSet.html#MultiSet"><span class="hs-identifier hs-type">MultiSet</span></a><span> </span><a href="#local-6989586621679032787"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Set</span><span> </span><a href="#local-6989586621679032787"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-617"></a><a name="toSet"><a href="Data.MultiSet.html#toSet"><span class="hs-identifier">toSet</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Map</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">keysSet</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier">unMS</span><span>
</span><a name="line-618"></a><span>
</span><a name="line-619"></a><span class="hs-comment">-- | /O(n)/. Convert a 'Set' to a multiset.</span><span>
</span><a name="line-620"></a><span class="hs-identifier">fromSet</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Set</span><span> </span><a href="#local-6989586621679032396"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.MultiSet.html#MultiSet"><span class="hs-identifier hs-type">MultiSet</span></a><span> </span><a href="#local-6989586621679032396"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-621"></a><a name="fromSet"><a href="Data.MultiSet.html#fromSet"><span class="hs-identifier">fromSet</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.MultiSet.html#fromDistinctAscList"><span class="hs-identifier hs-var">fromDistinctAscList</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">Set</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">toAscList</span><span>
</span><a name="line-622"></a><span>
</span><a name="line-623"></a><span class="hs-comment">{--------------------------------------------------------------------
  Instances 
--------------------------------------------------------------------}</span><span>
</span><a name="line-626"></a><span>
</span><a name="line-627"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Eq</span><span> </span><a href="#local-6989586621679032365"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">Eq</span><span> </span><span class="hs-special">(</span><a href="Data.MultiSet.html#MultiSet"><span class="hs-identifier hs-type">MultiSet</span></a><span> </span><a href="#local-6989586621679032365"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-628"></a><span>  </span><a name="local-6989586621679032366"><a href="#local-6989586621679032366"><span class="hs-identifier">m1</span></a></a><span> </span><a name="local-3458764513820541095"><span class="hs-operator">==</span></a><span> </span><a name="local-6989586621679032367"><a href="#local-6989586621679032367"><span class="hs-identifier">m2</span></a></a><span>  </span><span class="hs-glyph">=</span><span>  </span><span class="hs-identifier">unMS</span><span> </span><a href="#local-6989586621679032366"><span class="hs-identifier hs-var">m1</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-identifier">unMS</span><span> </span><a href="#local-6989586621679032367"><span class="hs-identifier hs-var">m2</span></a><span>
</span><a name="line-629"></a><span>
</span><a name="line-630"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Ord</span><span> </span><a href="#local-6989586621679032362"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">Ord</span><span> </span><span class="hs-special">(</span><a href="Data.MultiSet.html#MultiSet"><span class="hs-identifier hs-type">MultiSet</span></a><span> </span><a href="#local-6989586621679032362"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-631"></a><span>  </span><a name="local-8214565720323790367"><span class="hs-identifier">compare</span></a><span> </span><a name="local-6989586621679032363"><a href="#local-6989586621679032363"><span class="hs-identifier">s1</span></a></a><span> </span><a name="local-6989586621679032364"><a href="#local-6989586621679032364"><span class="hs-identifier">s2</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">compare</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">unMS</span><span> </span><a href="#local-6989586621679032363"><span class="hs-identifier hs-var">s1</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">unMS</span><span> </span><a href="#local-6989586621679032364"><span class="hs-identifier hs-var">s2</span></a><span class="hs-special">)</span><span>
</span><a name="line-632"></a><span>  </span><span class="hs-comment">{-
  -- compare s1 s2 = compare (toAscList s1) (toAscList s2) 
  -- We want {x,x,y} &lt; {x,y}
  -- i.e. if the number of occurrences differ, more occurrences come first.
  -- But also, {x,x} &gt; {x}
  -- so this does not hold at the end of the list.
  --
  -- To summarize:
  --    * [(x,2),(y,1)] &lt; [(x,1),(y,1)]
  --    * [(x,2)      ] &lt; [(x,1),(y,1)]
  --    * [(x,2),(y,1)] &gt; [(x,1)      ]
  --    * [(x,2)      ] &gt; [(x,1)      ]
  compare s1 s2 = comp (toAscOccurList s1) (toAscOccurList s2) 
    where comp []         []     = EQ
          comp []         (_:_)  = LT
          comp (_:_)      []     = GT
          comp ((x,n):xs) ((y,m):ys)
             = case compare x y of
                 EQ    -&gt; case compare n m of
                            EQ -&gt; comp xs ys
                            LT -&gt; case xs of
                                    [] -&gt; LT
                                    _  -&gt; GT
                            GT -&gt; case ys of
                                    [] -&gt; GT
                                    _  -&gt; LT
                 other -&gt; other
  -}</span><span>
</span><a name="line-660"></a><span>
</span><a name="line-661"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Show</span><span> </span><a href="#local-6989586621679032359"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">Show</span><span> </span><span class="hs-special">(</span><a href="Data.MultiSet.html#MultiSet"><span class="hs-identifier hs-type">MultiSet</span></a><span> </span><a href="#local-6989586621679032359"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-662"></a><span>  </span><a name="local-8214565720323790232"><span class="hs-identifier">showsPrec</span></a><span> </span><a name="local-6989586621679032360"><a href="#local-6989586621679032360"><span class="hs-identifier">p</span></a></a><span> </span><a name="local-6989586621679032361"><a href="#local-6989586621679032361"><span class="hs-identifier">xs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">showParen</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679032360"><span class="hs-identifier hs-var">p</span></a><span> </span><span class="hs-operator hs-var">&gt;</span><span> </span><span class="hs-number">10</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span>
</span><a name="line-663"></a><span>    </span><span class="hs-identifier hs-var">showString</span><span> </span><span class="hs-string">&quot;fromOccurList &quot;</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">shows</span><span> </span><span class="hs-special">(</span><a href="Data.MultiSet.html#toOccurList"><span class="hs-identifier hs-var">toOccurList</span></a><span> </span><a href="#local-6989586621679032361"><span class="hs-identifier hs-var">xs</span></a><span class="hs-special">)</span><span>
</span><a name="line-664"></a><span>
</span><a name="line-665"></a><span class="hs-comment">{--------------------------------------------------------------------
  Read
--------------------------------------------------------------------}</span><span>
</span><a name="line-668"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Read</span><span> </span><a href="#local-6989586621679031961"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Ord</span><span> </span><a href="#local-6989586621679031961"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">Read</span><span> </span><span class="hs-special">(</span><a href="Data.MultiSet.html#MultiSet"><span class="hs-identifier hs-type">MultiSet</span></a><span> </span><a href="#local-6989586621679031961"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-669"></a><span class="hs-cpp">#ifdef __GLASGOW_HASKELL__</span><span>
</span><a name="line-670"></a><span>  </span><a name="local-8214565720323789940"><span class="hs-identifier">readPrec</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">parens</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">prec</span><span> </span><span class="hs-number">10</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-671"></a><span>    </span><span class="hs-identifier hs-var">Ident</span><span> </span><span class="hs-string">&quot;fromOccurList&quot;</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">lexP</span><span>
</span><a name="line-672"></a><span>    </span><a name="local-6989586621679032358"><a href="#local-6989586621679032358"><span class="hs-identifier">xs</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">readPrec</span><span>
</span><a name="line-673"></a><span>    </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><a href="Data.MultiSet.html#fromOccurList"><span class="hs-identifier hs-var">fromOccurList</span></a><span> </span><a href="#local-6989586621679032358"><span class="hs-identifier hs-var">xs</span></a><span class="hs-special">)</span><span>
</span><a name="line-674"></a><span>
</span><a name="line-675"></a><span>  </span><a name="local-8214565720323789939"><span class="hs-identifier">readListPrec</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">readListPrecDefault</span><span>
</span><a name="line-676"></a><span class="hs-cpp">#else</span><span>
</span><a name="line-677"></a><span>  </span><span class="hs-identifier">readsPrec</span><span> </span><span class="hs-identifier">p</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">readParen</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">p</span><span> </span><span class="hs-operator">&gt;</span><span> </span><span class="hs-number">10</span><span class="hs-special">)</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-glyph">\</span><span> </span><span class="hs-identifier">r</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-678"></a><span>    </span><span class="hs-special">(</span><span class="hs-string">&quot;fromOccurList&quot;</span><span class="hs-special">,</span><span class="hs-identifier">s</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier">lex</span><span> </span><span class="hs-identifier">r</span><span>
</span><a name="line-679"></a><span>    </span><span class="hs-special">(</span><span class="hs-identifier">xs</span><span class="hs-special">,</span><span class="hs-identifier">t</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier">reads</span><span> </span><span class="hs-identifier">s</span><span>
</span><a name="line-680"></a><span>    </span><span class="hs-identifier">return</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">fromOccurList</span><span> </span><span class="hs-identifier">xs</span><span class="hs-special">,</span><span class="hs-identifier">t</span><span class="hs-special">)</span><span>
</span><a name="line-681"></a><span class="hs-cpp">#endif</span><span>
</span><a name="line-682"></a><span>
</span><a name="line-683"></a><span class="hs-comment">{--------------------------------------------------------------------
  Typeable/Data
--------------------------------------------------------------------}</span><span>
</span><a name="line-686"></a><span>
</span><a name="line-687"></a><span class="hs-cpp">#if __GLASGOW_HASKELL__ &lt; 800</span><span>
</span><a name="line-688"></a><span class="hs-cpp">#include &quot;Typeable.h&quot;</span><span>
</span><a name="line-689"></a><span class="hs-identifier">INSTANCE_TYPEABLE1</span><span class="hs-special">(</span><span class="hs-identifier">MultiSet</span><span class="hs-special">,</span><span class="hs-identifier">multiSetTc</span><span class="hs-special">,</span><span class="hs-string">&quot;MultiSet&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-690"></a><span class="hs-cpp">#endif</span><span>
</span><a name="line-691"></a><span>
</span><a name="line-692"></a><span class="hs-comment">{--------------------------------------------------------------------
  Split
--------------------------------------------------------------------}</span><span>
</span><a name="line-695"></a><span>
</span><a name="line-696"></a><span class="hs-comment">-- | /O(log n)/. The expression (@'split' x set@) is a pair @(set1,set2)@</span><span>
</span><a name="line-697"></a><span class="hs-comment">-- where all elements in @set1@ are lower than @x@ and all elements in</span><span>
</span><a name="line-698"></a><span class="hs-comment">-- @set2@ larger than @x@. @x@ is not found in neither @set1@ nor @set2@.</span><span>
</span><a name="line-699"></a><span class="hs-identifier">split</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Ord</span><span> </span><a href="#local-6989586621679032395"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="#local-6989586621679032395"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.MultiSet.html#MultiSet"><span class="hs-identifier hs-type">MultiSet</span></a><span> </span><a href="#local-6989586621679032395"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="Data.MultiSet.html#MultiSet"><span class="hs-identifier hs-type">MultiSet</span></a><span> </span><a href="#local-6989586621679032395"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><a href="Data.MultiSet.html#MultiSet"><span class="hs-identifier hs-type">MultiSet</span></a><span> </span><a href="#local-6989586621679032395"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-700"></a><a name="split"><a href="Data.MultiSet.html#split"><span class="hs-identifier">split</span></a></a><span> </span><a name="local-6989586621679033456"><a href="#local-6989586621679033456"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><a name="local-6989586621679033457"><a href="#local-6989586621679033457"><span class="hs-identifier">x</span></a></a><span class="hs-special">,</span><a name="local-6989586621679033458"><a href="#local-6989586621679033458"><span class="hs-identifier">y</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="Data.MultiSet.html#MS"><span class="hs-identifier hs-var">MS</span></a><span> </span><a href="#local-6989586621679033457"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">,</span><span> </span><a href="Data.MultiSet.html#MS"><span class="hs-identifier hs-var">MS</span></a><span> </span><a href="#local-6989586621679033458"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">Map</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">split</span><span> </span><a href="#local-6989586621679033456"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier">unMS</span><span>
</span><a name="line-701"></a><span>
</span><a name="line-702"></a><span class="hs-comment">-- | /O(log n)/. Performs a 'split' but also returns the number of</span><span>
</span><a name="line-703"></a><span class="hs-comment">-- occurrences of the pivot element in the original set.</span><span>
</span><a name="line-704"></a><span class="hs-identifier">splitOccur</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Ord</span><span> </span><a href="#local-6989586621679032394"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="#local-6989586621679032394"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.MultiSet.html#MultiSet"><span class="hs-identifier hs-type">MultiSet</span></a><span> </span><a href="#local-6989586621679032394"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="Data.MultiSet.html#MultiSet"><span class="hs-identifier hs-type">MultiSet</span></a><span> </span><a href="#local-6989586621679032394"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><a href="Data.MultiSet.html#Occur"><span class="hs-identifier hs-type">Occur</span></a><span class="hs-special">,</span><a href="Data.MultiSet.html#MultiSet"><span class="hs-identifier hs-type">MultiSet</span></a><span> </span><a href="#local-6989586621679032394"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-705"></a><a name="splitOccur"><a href="Data.MultiSet.html#splitOccur"><span class="hs-identifier">splitOccur</span></a></a><span> </span><a name="local-6989586621679033459"><a href="#local-6989586621679033459"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.MultiSet.html#MS"><span class="hs-identifier hs-var">MS</span></a><span> </span><a name="local-6989586621679033460"><a href="#local-6989586621679033460"><span class="hs-identifier">t</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679033461"><a href="#local-6989586621679033461"><span class="hs-identifier">l</span></a></a><span class="hs-special">,</span><a name="local-6989586621679033462"><a href="#local-6989586621679033462"><span class="hs-identifier">m</span></a></a><span class="hs-special">,</span><a name="local-6989586621679033463"><a href="#local-6989586621679033463"><span class="hs-identifier">r</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Map</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">splitLookup</span><span> </span><a href="#local-6989586621679033459"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="#local-6989586621679033460"><span class="hs-identifier hs-var">t</span></a><span> </span><span class="hs-keyword">in</span><span>
</span><a name="line-706"></a><span>     </span><span class="hs-special">(</span><a href="Data.MultiSet.html#MS"><span class="hs-identifier hs-var">MS</span></a><span> </span><a href="#local-6989586621679033461"><span class="hs-identifier hs-var">l</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">maybe</span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-identifier hs-var">id</span><span> </span><a href="#local-6989586621679033462"><span class="hs-identifier hs-var">m</span></a><span class="hs-special">,</span><span> </span><a href="Data.MultiSet.html#MS"><span class="hs-identifier hs-var">MS</span></a><span> </span><a href="#local-6989586621679033463"><span class="hs-identifier hs-var">r</span></a><span class="hs-special">)</span><span>
</span><a name="line-707"></a><span>
</span><a name="line-708"></a><span class="hs-comment">{--------------------------------------------------------------------
  Utilities
--------------------------------------------------------------------}</span><span>
</span><a name="line-711"></a><span>
</span><a name="line-712"></a><span class="hs-comment">-- TODO : Use foldl' from base?</span><span>
</span><a name="line-713"></a><span class="hs-identifier">foldlStrict</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679032392"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679032393"><span class="hs-identifier hs-type">t</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679032392"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679032392"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679032393"><span class="hs-identifier hs-type">t</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679032392"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-714"></a><a name="foldlStrict"><a href="Data.MultiSet.html#foldlStrict"><span class="hs-identifier">foldlStrict</span></a></a><span> </span><a name="local-6989586621679033488"><a href="#local-6989586621679033488"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679033489"><a href="#local-6989586621679033489"><span class="hs-identifier">z</span></a></a><span> </span><a name="local-6989586621679033490"><a href="#local-6989586621679033490"><span class="hs-identifier">xs</span></a></a><span>
</span><a name="line-715"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679033490"><span class="hs-identifier hs-var">xs</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-716"></a><span>      </span><span class="hs-special">[</span><span class="hs-special">]</span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679033489"><span class="hs-identifier hs-var">z</span></a><span>
</span><a name="line-717"></a><span>      </span><span class="hs-special">(</span><a name="local-6989586621679033491"><a href="#local-6989586621679033491"><span class="hs-identifier">x</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679033492"><a href="#local-6989586621679033492"><span class="hs-identifier">xx</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679033493"><a href="#local-6989586621679033493"><span class="hs-identifier">z'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679033488"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679033489"><span class="hs-identifier hs-var">z</span></a><span> </span><a href="#local-6989586621679033491"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-keyword">in</span><span> </span><span class="hs-identifier hs-var">seq</span><span> </span><a href="#local-6989586621679033493"><span class="hs-identifier hs-var">z'</span></a><span> </span><span class="hs-special">(</span><a href="Data.MultiSet.html#foldlStrict"><span class="hs-identifier hs-var">foldlStrict</span></a><span> </span><a href="#local-6989586621679033488"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679033493"><span class="hs-identifier hs-var">z'</span></a><span> </span><a href="#local-6989586621679033492"><span class="hs-identifier hs-var">xx</span></a><span class="hs-special">)</span><span>
</span><a name="line-718"></a><span>
</span><a name="line-719"></a><span>
</span><a name="line-720"></a><span class="hs-comment">{--------------------------------------------------------------------
  Debugging
--------------------------------------------------------------------}</span><span>
</span><a name="line-723"></a><span class="hs-comment">-- | /O(n)/. Show the tree that implements the set. The tree is shown</span><span>
</span><a name="line-724"></a><span class="hs-comment">-- in a compressed, hanging format.</span><span>
</span><a name="line-725"></a><span class="hs-identifier">showTree</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Show</span><span> </span><a href="#local-6989586621679032391"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Data.MultiSet.html#MultiSet"><span class="hs-identifier hs-type">MultiSet</span></a><span> </span><a href="#local-6989586621679032391"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">String</span><span>
</span><a name="line-726"></a><a name="showTree"><a href="Data.MultiSet.html#showTree"><span class="hs-identifier">showTree</span></a></a><span> </span><a name="local-6989586621679033494"><a href="#local-6989586621679033494"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.MultiSet.html#showTreeWith"><span class="hs-identifier hs-var">showTreeWith</span></a><span> </span><span class="hs-identifier hs-var">True</span><span> </span><span class="hs-identifier hs-var">False</span><span> </span><a href="#local-6989586621679033494"><span class="hs-identifier hs-var">s</span></a><span>
</span><a name="line-727"></a><span>
</span><a name="line-728"></a><span>
</span><a name="line-729"></a><span class="hs-comment">{- | /O(n)/. The expression (@showTreeWith hang wide map@) shows
 the tree that implements the set. If @hang@ is
 @True@, a /hanging/ tree is shown otherwise a rotated tree is shown. If
 @wide@ is 'True', an extra wide version is shown.

&gt; Set&gt; putStrLn $ showTreeWith True False $ fromDistinctAscList [1,1,2,3,4,5]
&gt; (1*) 4
&gt; +--(1*) 2
&gt; |  +--(2*) 1
&gt; |  +--(1*) 3
&gt; +--(1*) 5
&gt; 
&gt; Set&gt; putStrLn $ showTreeWith True True $ fromDistinctAscList [1,1,2,3,4,5]
&gt; (1*) 4
&gt; |
&gt; +--(1*) 2
&gt; |  |
&gt; |  +--(2*) 1
&gt; |  |
&gt; |  +--(1*) 3
&gt; |
&gt; +--(1*) 5
&gt; 
&gt; Set&gt; putStrLn $ showTreeWith False True $ fromDistinctAscList [1,1,2,3,4,5]
&gt; +--(1*) 5
&gt; |
&gt; (1*) 4
&gt; |
&gt; |  +--(1*) 3
&gt; |  |
&gt; +--(1*) 2
&gt;    |
&gt;    +--(2*) 1

-}</span><span>
</span><a name="line-764"></a><span class="hs-identifier">showTreeWith</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Show</span><span> </span><a href="#local-6989586621679032390"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.MultiSet.html#MultiSet"><span class="hs-identifier hs-type">MultiSet</span></a><span> </span><a href="#local-6989586621679032390"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">String</span><span>
</span><a name="line-765"></a><a name="showTreeWith"><a href="Data.MultiSet.html#showTreeWith"><span class="hs-identifier">showTreeWith</span></a></a><span> </span><a name="local-6989586621679033495"><a href="#local-6989586621679033495"><span class="hs-identifier">hang</span></a></a><span> </span><a name="local-6989586621679033496"><a href="#local-6989586621679033496"><span class="hs-identifier">wide</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Map</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">showTreeWith</span><span> </span><a href="#local-6989586621679033497"><span class="hs-identifier hs-var">s</span></a><span> </span><a href="#local-6989586621679033495"><span class="hs-identifier hs-var">hang</span></a><span> </span><a href="#local-6989586621679033496"><span class="hs-identifier hs-var">wide</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier">unMS</span><span>
</span><a name="line-766"></a><span>  </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621679033497"><a href="#local-6989586621679033497"><span class="hs-identifier">s</span></a></a><span> </span><a name="local-6989586621679033498"><a href="#local-6989586621679033498"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679033499"><a href="#local-6989586621679033499"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">showChar</span><span> </span><span class="hs-char">'('</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">shows</span><span> </span><a href="#local-6989586621679033499"><span class="hs-identifier hs-var">n</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">showString</span><span> </span><span class="hs-string">&quot;*)&quot;</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">shows</span><span> </span><a href="#local-6989586621679033498"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-string">&quot;&quot;</span><span>
</span><a name="line-767"></a><span>
</span><a name="line-768"></a><span class="hs-comment">{--------------------------------------------------------------------
  Assertions
--------------------------------------------------------------------}</span><span>
</span><a name="line-771"></a><span class="hs-comment">-- | /O(n)/. Test if the internal multiset structure is valid.</span><span>
</span><a name="line-772"></a><span class="hs-identifier">valid</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Ord</span><span> </span><a href="#local-6989586621679032389"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Data.MultiSet.html#MultiSet"><span class="hs-identifier hs-type">MultiSet</span></a><span> </span><a href="#local-6989586621679032389"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-773"></a><a name="valid"><a href="Data.MultiSet.html#valid"><span class="hs-identifier">valid</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Map</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">valid</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier">unMS</span><span>
</span><a name="line-774"></a><span>
</span><a name="line-775"></a><span class="hs-comment">{-
{--------------------------------------------------------------------
  Testing
--------------------------------------------------------------------}
testTree :: [Int] -&gt; MultiSet Int
testTree xs   = fromList xs
test1 = testTree [1..20]
test2 = testTree [30,29..10]
test3 = testTree [1,4,6,89,2323,53,43,234,5,79,12,9,24,9,8,423,8,42,4,8,9,3]

{--------------------------------------------------------------------
  QuickCheck
--------------------------------------------------------------------}
qcheck prop
  = check config prop
  where
    config = Config
      { configMaxTest = 500
      , configMaxFail = 5000
      , configSize    = \n -&gt; (div n 2 + 3)
      , configEvery   = \n args -&gt; let s = show n in s ++ [ '\b' | _ &lt;- s ]
      }


{--------------------------------------------------------------------
  Arbitrary, reasonably balanced trees
--------------------------------------------------------------------}
instance (Enum a) =&gt; Arbitrary (MultiSet a) where
  arbitrary = fromMap `fmap` arbitrary

{--------------------------------------------------------------------
  Valid tree's
--------------------------------------------------------------------}
forValid :: (Enum a,Show a,Testable b) =&gt; (MultiSet a -&gt; b) -&gt; Property
forValid f
  = forAll arbitrary $ \t -&gt; 
--    classify (balanced t) &quot;balanced&quot; $
    classify (size t == 0) &quot;empty&quot; $
    classify (size t &gt; 0  &amp;&amp; size t &lt;= 10) &quot;small&quot; $
    classify (size t &gt; 10 &amp;&amp; size t &lt;= 64) &quot;medium&quot; $
    classify (size t &gt; 64) &quot;large&quot; $
    balanced t ==&gt; f t

forValidIntTree :: Testable a =&gt; (MultiSet Int -&gt; a) -&gt; Property
forValidIntTree f
  = forValid f

forValidUnitTree :: Testable a =&gt; (MultiSet Int -&gt; a) -&gt; Property
forValidUnitTree f
  = forValid f


prop_Valid 
  = forValidUnitTree $ \t -&gt; valid t

{--------------------------------------------------------------------
  Single, Insert, Delete
--------------------------------------------------------------------}
prop_Single :: Int -&gt; Bool
prop_Single x
  = (insert x empty == singleton x)

prop_InsertValid :: Int -&gt; Property
prop_InsertValid k
  = forValidUnitTree $ \t -&gt; valid (insert k t)

prop_InsertDelete :: Int -&gt; MultiSet Int -&gt; Property
prop_InsertDelete k t
  = not (member k t) ==&gt; delete k (insert k t) == t

prop_InsertOne :: Int -&gt; MultiSet Int -&gt; Bool
prop_InsertOne x t
  = (insertMany x 1 empty == singleton x)

prop_DeleteValid :: Int -&gt; Property
prop_DeleteValid k
  = forValidUnitTree $ \t -&gt; 
    valid (delete k (insert k t))

{--------------------------------------------------------------------
  Balance
--------------------------------------------------------------------}
prop_Join :: Int -&gt; Property 
prop_Join x
  = forValidUnitTree $ \t -&gt;
    let (l,r) = split x t
    in valid (join x l r)

prop_Merge :: Int -&gt; Property 
prop_Merge x
  = forValidUnitTree $ \t -&gt;
    let (l,r) = split x t
    in valid (merge l r)


{--------------------------------------------------------------------
  Union
--------------------------------------------------------------------}
prop_UnionValid :: Property
prop_UnionValid
  = forValidUnitTree $ \t1 -&gt;
    forValidUnitTree $ \t2 -&gt;
    valid (union t1 t2)

prop_UnionInsert :: Int -&gt; Set Int -&gt; Bool
prop_UnionInsert x t
  = union t (singleton x) == insert x t

prop_UnionAssoc :: Set Int -&gt; Set Int -&gt; Set Int -&gt; Bool
prop_UnionAssoc t1 t2 t3
  = union t1 (union t2 t3) == union (union t1 t2) t3

prop_UnionComm :: Set Int -&gt; Set Int -&gt; Bool
prop_UnionComm t1 t2
  = (union t1 t2 == union t2 t1)


prop_DiffValid
  = forValidUnitTree $ \t1 -&gt;
    forValidUnitTree $ \t2 -&gt;
    valid (difference t1 t2)

prop_Diff :: [Int] -&gt; [Int] -&gt; Bool
prop_Diff xs ys
  =  toAscList (difference (fromList xs) (fromList ys))
    == List.sort ((List.\\) (nub xs)  (nub ys))

prop_IntValid
  = forValidUnitTree $ \t1 -&gt;
    forValidUnitTree $ \t2 -&gt;
    valid (intersection t1 t2)

prop_Int :: [Int] -&gt; [Int] -&gt; Bool
prop_Int xs ys
  =  toAscList (intersection (fromList xs) (fromList ys))
    == List.sort (nub ((List.intersect) (xs)  (ys)))

{--------------------------------------------------------------------
  Lists
--------------------------------------------------------------------}
prop_Ordered
  = forAll (choose (5,100)) $ \n -&gt;
    let xs = [0..n::Int]
    in fromAscList xs == fromList xs

prop_List :: [Int] -&gt; Bool
prop_List xs
  = (sort (nub xs) == toList (fromList xs))
-}</span><span>
</span><a name="line-924"></a></pre></body></html>